<!doctype html><html class=no-js lang=en><meta charset=utf-8><meta content="width=device-width,initial-scale=1" name=viewport><link href=https://seanslma.github.io/maki/SQL/MySQL/backup/ rel=canonical><link href=../alter/ rel=prev><link href=../bakcode/ rel=next><link href=../../../assets/images/favicon.png rel=icon><meta content="mkdocs-1.6.1, mkdocs-material-9.6.15" name=generator><title>backup - maki</title><link href=../../../assets/stylesheets/main.342714a4.min.css rel=stylesheet><link href=../../../assets/stylesheets/palette.06af60db.min.css rel=stylesheet><link crossorigin href=https://fonts.gstatic.com rel=preconnect><link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback" rel=stylesheet><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link href=../../../stylesheets/extra.css rel=stylesheet><script>__md_scope=new URL(`../../..`,location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+`.`+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+`.`+e,JSON.stringify(_))}catch{}};</script><body data-md-color-accent=indigo data-md-color-primary=indigo data-md-color-scheme=default dir=ltr><input autocomplete=off class=md-toggle data-md-toggle=drawer id=__drawer type=checkbox><input autocomplete=off class=md-toggle data-md-toggle=search id=__search type=checkbox><label class=md-overlay for=__drawer></label><div data-md-component=skip><a class=md-skip href=#backup> Skip to content </a></div><div data-md-component=announce></div><header class=md-header data-md-component=header><nav class="md-header__inner md-grid" aria-label=Header><a class="md-header__button md-logo" aria-label=maki data-md-component=logo href=../../.. title=maki> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a><label class="md-header__button md-icon" for=__drawer><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg></label><div class=md-header__title data-md-component=header-title><div class=md-header__ellipsis><div class=md-header__topic><span class=md-ellipsis> maki </span></div><div class=md-header__topic data-md-component=header-topic><span class=md-ellipsis> backup </span></div></div></div><form class=md-header__option data-md-component=palette><input aria-label="Switch to dark mode" class=md-option data-md-color-accent=indigo data-md-color-media data-md-color-primary=indigo data-md-color-scheme=default id=__palette_0 name=__palette type=radio><label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg></label><input aria-label="Switch to light mode" class=md-option data-md-color-accent=indigo data-md-color-media data-md-color-primary=indigo data-md-color-scheme=slate id=__palette_1 name=__palette type=radio><label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg></label></form><script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script><label class="md-header__button md-icon" for=__search><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg></label><div class=md-search data-md-component=search role=dialog><label class=md-search__overlay for=__search></label><div class=md-search__inner role=search><form class=md-search__form name=search><input aria-label=Search autocapitalize=off autocomplete=off autocorrect=off class=md-search__input data-md-component=search-query name=query placeholder=Search required spellcheck=false><label class="md-search__icon md-icon" for=__search><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg></label><nav aria-label=Search class=md-search__options><button class="md-search__icon md-icon" aria-label=Clear tabindex=-1 title=Clear type=reset><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg></button></nav><div class=md-search__suggest data-md-component=search-suggest></div></form><div class=md-search__output><div class=md-search__scrollwrap data-md-scrollfix tabindex=0><div class=md-search-result data-md-component=search-result><div class=md-search-result__meta>Initializing search</div><ol class=md-search-result__list role=presentation></ol></div></div></div></div></div><div class=md-header__source><a title="Go to repository" class=md-source data-md-component=source href=https://github.com/seanslma/maki> <div class="md-source__icon md-icon"><svg viewbox="0 0 448 512" xmlns=http://www.w3.org/2000/svg><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg></div> <div class=md-source__repository>GitHub</div> </a></div></nav></header><div class=md-container data-md-component=container><nav aria-label=Tabs class=md-tabs data-md-component=tabs><div class=md-grid><ul class=md-tabs__list><li class=md-tabs__item><a class=md-tabs__link href=../../..> About </a><li class=md-tabs__item><a class=md-tabs__link href=../../../AI/ChatGPT/> AI </a><li class=md-tabs__item><a class=md-tabs__link href=../../../AWS/CDN/> AWS </a><li class=md-tabs__item><a class=md-tabs__link href=../../../Azure/Advisor/> Azure </a><li class=md-tabs__item><a class=md-tabs__link href=../../../Coding/Notepad%2B%2B/> Coding </a><li class=md-tabs__item><a class=md-tabs__link href=../../../Cybersecurity/Cybersecurity/> Cybersecurity </a><li class=md-tabs__item><a class=md-tabs__link href=../../../Data/Data/> Data </a><li class=md-tabs__item><a class=md-tabs__link href=../../../DevOps/DevOps/> DevOps </a><li class=md-tabs__item><a class=md-tabs__link href=../../../Documentation/Jira/> Documentation </a><li class=md-tabs__item><a class=md-tabs__link href=../../../Energy/Inertia/> Energy </a><li class=md-tabs__item><a class=md-tabs__link href=../../../Learn/Book/> Learn </a><li class=md-tabs__item><a class=md-tabs__link href=../../../ML/Backtest/> ML </a><li class=md-tabs__item><a class=md-tabs__link href=../../../Optimizaton/Convex/> Optimizaton </a><li class=md-tabs__item><a class=md-tabs__link href=../../../PowerBI/Basic/> PowerBI </a><li class=md-tabs__item><a class=md-tabs__link href=../../../Python/Basic/> Python </a><li class="md-tabs__item md-tabs__item--active"><a class=md-tabs__link href=../../Database/> SQL </a><li class=md-tabs__item><a class=md-tabs__link href=../../../System/Behavior/> System </a></ul></div></nav><main class=md-main data-md-component=main><div class="md-main__inner md-grid"><div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation><div class=md-sidebar__scrollwrap><div class=md-sidebar__inner><nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0><label class=md-nav__title for=__drawer><a class="md-nav__button md-logo" aria-label=maki data-md-component=logo href=../../.. title=maki> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> maki</label><div class=md-nav__source><a title="Go to repository" class=md-source data-md-component=source href=https://github.com/seanslma/maki> <div class="md-source__icon md-icon"><svg viewbox="0 0 448 512" xmlns=http://www.w3.org/2000/svg><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg></div> <div class=md-source__repository>GitHub</div> </a></div><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../..> <span class=md-ellipsis> About </span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../../AI/ChatGPT/> <span class=md-ellipsis> AI </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../../AWS/CDN/> <span class=md-ellipsis> AWS </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../../Azure/Advisor/> <span class=md-ellipsis> Azure </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../../Coding/Notepad%2B%2B/> <span class=md-ellipsis> Coding </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../../Cybersecurity/Cybersecurity/> <span class=md-ellipsis> Cybersecurity </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../../Data/Data/> <span class=md-ellipsis> Data </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../../DevOps/DevOps/> <span class=md-ellipsis> DevOps </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../../Documentation/Jira/> <span class=md-ellipsis> Documentation </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../../Energy/Inertia/> <span class=md-ellipsis> Energy </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../../Learn/Book/> <span class=md-ellipsis> Learn </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../../ML/Backtest/> <span class=md-ellipsis> ML </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../../Optimizaton/Convex/> <span class=md-ellipsis> Optimizaton </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../../PowerBI/Basic/> <span class=md-ellipsis> PowerBI </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../../Python/Basic/> <span class=md-ellipsis> Python </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle" checked id=__nav_16 type=checkbox> <label class=md-nav__link for=__nav_16 id=__nav_16_label><span class=md-ellipsis> SQL </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=true aria-labelledby=__nav_16_label class=md-nav data-md-level=1><label class=md-nav__title for=__nav_16><span class="md-nav__icon md-icon"></span> SQL</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../Database/> <span class=md-ellipsis> Database </span> </a><li class=md-nav__item><a class=md-nav__link href=../../Test/> <span class=md-ellipsis> Test </span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../Access/cs/> <span class=md-ellipsis> Access </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../DuckDB/Datetime/> <span class=md-ellipsis> DuckDB </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../IoTDB/Cluster/> <span class=md-ellipsis> IoTDB </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../MSSQL/ANSI_NULLS/> <span class=md-ellipsis> MSSQL </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../MongoDB/Sharding/> <span class=md-ellipsis> MongoDB </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--active md-nav__item--nested"><input class="md-nav__toggle md-toggle" checked id=__nav_16_8 type=checkbox> <label class=md-nav__link for=__nav_16_8 id=__nav_16_8_label tabindex=0><span class=md-ellipsis> MySQL </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=true aria-labelledby=__nav_16_8_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_16_8><span class="md-nav__icon md-icon"></span> MySQL</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../InnoDB/> <span class=md-ellipsis> InnoDB </span> </a><li class=md-nav__item><a class=md-nav__link href=../PerconaToolkit/> <span class=md-ellipsis> percona-toolkit </span> </a><li class=md-nav__item><a class=md-nav__link href=../adm/> <span class=md-ellipsis> Admin </span> </a><li class=md-nav__item><a class=md-nav__link href=../alter/> <span class=md-ellipsis> alter table </span> </a><li class="md-nav__item md-nav__item--active"><input class="md-nav__toggle md-toggle" id=__toc type=checkbox> <label class="md-nav__link md-nav__link--active" for=__toc><span class=md-ellipsis> backup </span> <span class="md-nav__icon md-icon"></span></label> <a class="md-nav__link md-nav__link--active" href=./> <span class=md-ellipsis> backup </span> </a> <nav aria-label="Table of contents" class="md-nav md-nav--secondary"><label class=md-nav__title for=__toc><span class="md-nav__icon md-icon"></span> Table of contents</label><ul class=md-nav__list data-md-component=toc data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=#compress> <span class=md-ellipsis> compress </span> </a><li class=md-nav__item><a class=md-nav__link href=#check-process> <span class=md-ellipsis> check process </span> </a><li class=md-nav__item><a class=md-nav__link href=#log-slow-queries> <span class=md-ellipsis> log-slow-queries </span> </a><li class=md-nav__item><a class=md-nav__link href=#get-all-tables-in-db> <span class=md-ellipsis> get all tables in db </span> </a><li class=md-nav__item><a class=md-nav__link href=#lost-connection-during-query-when-dumping> <span class=md-ellipsis> Lost connection during query when dumping </span> </a><li class=md-nav__item><a class=md-nav__link href=#dump-to-tsv> <span class=md-ellipsis> dump to tsv </span> </a><li class=md-nav__item><a class=md-nav__link href=#dump-to-csv> <span class=md-ellipsis> dump to csv </span> </a><li class=md-nav__item><a class=md-nav__link href=#dump-db-with-each-table-in-a-separate-file> <span class=md-ellipsis> dump db with each table in a separate file </span> </a><li class=md-nav__item><a class=md-nav__link href=#dump-db-with-each-table-in-a-separate-file_1> <span class=md-ellipsis> dump db with each table in a separate file </span> </a><li class=md-nav__item><a class=md-nav__link href=#dump-db-with-each-table-in-a-separate-file_2> <span class=md-ellipsis> dump db with each table in a separate file </span> </a><li class=md-nav__item><a class=md-nav__link href=#disbale-key-checking> <span class=md-ellipsis> disbale key checking </span> </a></ul></nav><li class=md-nav__item><a class=md-nav__link href=../bakcode/> <span class=md-ellipsis> backup code </span> </a><li class=md-nav__item><a class=md-nav__link href=../basic/> <span class=md-ellipsis> Basic </span> </a><li class=md-nav__item><a class=md-nav__link href=../deadlock/> <span class=md-ellipsis> Deadlock </span> </a><li class=md-nav__item><a class=md-nav__link href=../err/> <span class=md-ellipsis> error </span> </a><li class=md-nav__item><a class=md-nav__link href=../group/> <span class=md-ellipsis> group </span> </a><li class=md-nav__item><a class=md-nav__link href=../io/> <span class=md-ellipsis> IO </span> </a><li class=md-nav__item><a class=md-nav__link href=../keyrepair/> <span class=md-ellipsis> key repair </span> </a><li class=md-nav__item><a class=md-nav__link href=../mem/> <span class=md-ellipsis> memory </span> </a><li class=md-nav__item><a class=md-nav__link href=../myisam2innodb/> <span class=md-ellipsis> MyISAM to InnoDB </span> </a><li class=md-nav__item><a class=md-nav__link href=../other/> <span class=md-ellipsis> other </span> </a><li class=md-nav__item><a class=md-nav__link href=../param/> <span class=md-ellipsis> param </span> </a><li class=md-nav__item><a class=md-nav__link href=../partition/> <span class=md-ellipsis> Partition </span> </a><li class=md-nav__item><a class=md-nav__link href=../perf/> <span class=md-ellipsis> perf </span> </a><li class=md-nav__item><a class=md-nav__link href=../procedure/> <span class=md-ellipsis> Procedure </span> </a><li class=md-nav__item><a class=md-nav__link href=../profile/> <span class=md-ellipsis> Profiling </span> </a><li class=md-nav__item><a class=md-nav__link href=../qry/> <span class=md-ellipsis> query </span> </a><li class=md-nav__item><a class=md-nav__link href=../shadding/> <span class=md-ellipsis> Shadding </span> </a><li class=md-nav__item><a class=md-nav__link href=../tip/> <span class=md-ellipsis> tip </span> </a><li class=md-nav__item><a class=md-nav__link href=../user/> <span class=md-ellipsis> user </span> </a></ul></nav><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../Oracle/Admin/> <span class=md-ellipsis> Oracle </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../PostgreSQL/Basic/> <span class=md-ellipsis> PostgreSQL </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../Security/Encryption/> <span class=md-ellipsis> Security </span> <span class="md-nav__icon md-icon"></span> </a></ul></nav><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../../System/Behavior/> <span class=md-ellipsis> System </span> <span class="md-nav__icon md-icon"></span> </a></ul></nav></div></div></div><div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc><div class=md-sidebar__scrollwrap><div class=md-sidebar__inner><nav aria-label="Table of contents" class="md-nav md-nav--secondary"><label class=md-nav__title for=__toc><span class="md-nav__icon md-icon"></span> Table of contents</label><ul class=md-nav__list data-md-component=toc data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=#compress> <span class=md-ellipsis> compress </span> </a><li class=md-nav__item><a class=md-nav__link href=#check-process> <span class=md-ellipsis> check process </span> </a><li class=md-nav__item><a class=md-nav__link href=#log-slow-queries> <span class=md-ellipsis> log-slow-queries </span> </a><li class=md-nav__item><a class=md-nav__link href=#get-all-tables-in-db> <span class=md-ellipsis> get all tables in db </span> </a><li class=md-nav__item><a class=md-nav__link href=#lost-connection-during-query-when-dumping> <span class=md-ellipsis> Lost connection during query when dumping </span> </a><li class=md-nav__item><a class=md-nav__link href=#dump-to-tsv> <span class=md-ellipsis> dump to tsv </span> </a><li class=md-nav__item><a class=md-nav__link href=#dump-to-csv> <span class=md-ellipsis> dump to csv </span> </a><li class=md-nav__item><a class=md-nav__link href=#dump-db-with-each-table-in-a-separate-file> <span class=md-ellipsis> dump db with each table in a separate file </span> </a><li class=md-nav__item><a class=md-nav__link href=#dump-db-with-each-table-in-a-separate-file_1> <span class=md-ellipsis> dump db with each table in a separate file </span> </a><li class=md-nav__item><a class=md-nav__link href=#dump-db-with-each-table-in-a-separate-file_2> <span class=md-ellipsis> dump db with each table in a separate file </span> </a><li class=md-nav__item><a class=md-nav__link href=#disbale-key-checking> <span class=md-ellipsis> disbale key checking </span> </a></ul></nav></div></div></div><div class=md-content data-md-component=content><article class="md-content__inner md-typeset"><h1 id=backup>backup<a title="Permanent link" class=headerlink href=#backup>¶</a></h1><ul><li><p>disable slow log</p><li><p>change tmp dir to a large drive</p><li><p>change repair params to large values</p></ul><h2 id=compress>compress<a title="Permanent link" class=headerlink href=#compress>¶</a></h2><p>Defragmentation will not only recover space, it will also help the queries run faster. After dumping and import the data can become larger, compress it<div class=highlight><pre><span></span><code><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a>optimize<span class=w> </span>table<span class=w> </span>tb1,<span class=w> </span>tb2
<a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>mysqlcheck<span class=w> </span>-o<span class=w> </span>db<span class=w> </span>tb<span class=w> </span><span class=c1>#mysqlcheck uses “OPTIMIZE TABLE” command</span>
<a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>mysqlcheck<span class=w> </span>-o<span class=w> </span>db<span class=w>    </span><span class=c1>#all tbs</span>
<a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>mysqlcheck<span class=w> </span>-o<span class=w> </span>-A<span class=w>    </span><span class=c1>#all dbs</span>
</code></pre></div><h2 id=check-process>check process<a title="Permanent link" class=headerlink href=#check-process>¶</a></h2><p>select * from INFORMATION_SCHEMA.PROCESSLIST where db = 'dbname';<h2 id=log-slow-queries>log-slow-queries<a title="Permanent link" class=headerlink href=#log-slow-queries>¶</a></h2><p>If you are importing using: <code>mysql -u user -p db_name &lt; db.sql</code>, check that you do <strong>NOT</strong> have "log-slow-queries" turned on.<div class=highlight><pre><span></span><code><a href=#__codelineno-1-1 id=__codelineno-1-1 name=__codelineno-1-1></a>show<span class=w> </span>global<span class=w> </span>variables<span class=w> </span>like<span class=w> </span><span class=s1>'%slow%'</span><span class=p>;</span>
<a href=#__codelineno-1-2 id=__codelineno-1-2 name=__codelineno-1-2></a><span class=nb>set</span><span class=w> </span>global<span class=w> </span><span class=nv>slow_query_log</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>'OFF'</span><span class=p>;</span>
</code></pre></div><h2 id=get-all-tables-in-db>get all tables in db<a title="Permanent link" class=headerlink href=#get-all-tables-in-db>¶</a></h2><div class=highlight><pre><span></span><code><a href=#__codelineno-2-1 id=__codelineno-2-1 name=__codelineno-2-1></a><span class=k>select</span><span class=w> </span><span class=k>table_name</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=s1>'tbl'</span>
<a href=#__codelineno-2-2 id=__codelineno-2-2 name=__codelineno-2-2></a><span class=k>from</span><span class=w> </span><span class=n>information_schema</span><span class=p>.</span><span class=n>tables</span>
<a href=#__codelineno-2-3 id=__codelineno-2-3 name=__codelineno-2-3></a><span class=k>where</span><span class=w> </span><span class=n>table_schema</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>'database_name'</span><span class=p>;</span>
</code></pre></div><h2 id=lost-connection-during-query-when-dumping>Lost connection during query when dumping<a title="Permanent link" class=headerlink href=#lost-connection-during-query-when-dumping>¶</a></h2><p>possible solutions, increase the variables values:<div class=highlight><pre><span></span><code><a href=#__codelineno-3-1 id=__codelineno-3-1 name=__codelineno-3-1></a>mysqldump<span class=w> </span>--net-read-timeout<span class=o>=</span><span class=m>7200</span><span class=w> </span>--net-write-timeout<span class=o>=</span><span class=m>7200</span>
<a href=#__codelineno-3-2 id=__codelineno-3-2 name=__codelineno-3-2></a><span class=w>          </span>--net-buffer-length<span class=o>=</span><span class=m>32704</span><span class=w> </span>--max_allowed-packet<span class=o>=</span>1024M
</code></pre></div><p>use --compress (does not work):<div class=highlight><pre><span></span><code><a href=#__codelineno-4-1 id=__codelineno-4-1 name=__codelineno-4-1></a>mysqldump<span class=w> </span>--defaults-extra-file<span class=o>=</span><span class=nv>$dir</span>/svr1.cnf<span class=w> </span><span class=nv>$db</span><span class=w> </span><span class=nv>$tb</span><span class=w> </span><span class=p>|</span>
<a href=#__codelineno-4-2 id=__codelineno-4-2 name=__codelineno-4-2></a>mysql<span class=w> </span>--defaults-extra-file<span class=o>=</span><span class=nv>$dir</span>/svr2.cnf<span class=w> </span>--compress<span class=w> </span><span class=nv>$db</span>
</code></pre></div><h2 id=dump-to-tsv>dump to tsv<a title="Permanent link" class=headerlink href=#dump-to-tsv>¶</a></h2><p>when using LOAD DATA INFILE, the character set should be set to the character set of the source csv file. This again should be the same as the character set in the definition of the table. So when using mysqldump to create the csv files, the character set should also be set to the character set in the table.<p>get table character set:<div class=highlight><pre><span></span><code><a href=#__codelineno-5-1 id=__codelineno-5-1 name=__codelineno-5-1></a>SHOW<span class=w> </span>FULL<span class=w> </span>COLUMNS<span class=w> </span>FROM<span class=w> </span>db.tb<span class=p>;</span>
</code></pre></div><div class=highlight><pre><span></span><code><a href=#__codelineno-6-1 id=__codelineno-6-1 name=__codelineno-6-1></a>mysqldump -h host -P port -u user -ppass --tab=/dir mydb mytable
<a href=#__codelineno-6-2 id=__codelineno-6-2 name=__codelineno-6-2></a>$ mysql -h localhost -u root -p
<a href=#__codelineno-6-3 id=__codelineno-6-3 name=__codelineno-6-3></a>mysql<span class=p>></span> LOAD DATA INFILE '/tmp/mytable.txt' INTO TABLE mytable;
<a href=#__codelineno-6-4 id=__codelineno-6-4 name=__codelineno-6-4></a>
<a href=#__codelineno-6-5 id=__codelineno-6-5 name=__codelineno-6-5></a><span class=k>set</span> <span class=nv>qry</span><span class=p>=</span>USE db1;LOAD DATA LOCAL INFILE '!file!' INTO TABLE <span class=nv>!table!</span>
<a href=#__codelineno-6-6 id=__codelineno-6-6 name=__codelineno-6-6></a><span class=k>set</span> <span class=nv>pa1</span><span class=p>=</span>FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '<span class=s2>"^""'</span>
<a href=#__codelineno-6-7 id=__codelineno-6-7 name=__codelineno-6-7></a><span class=k>set</span> <span class=nv>pa2</span><span class=p>=</span>LINES TERMINATED BY '\n' character-set latin1 IGNORE 1 LINES;
<a href=#__codelineno-6-8 id=__codelineno-6-8 name=__codelineno-6-8></a><span class=k>set</span> <span class=nv>sql_qry</span><span class=p>=</span><span class=nv>%qry%</span> <span class=nv>%pa1%</span> <span class=nv>%pa2%</span>
<a href=#__codelineno-6-9 id=__codelineno-6-9 name=__codelineno-6-9></a>mysql -u root --password=<span class=nv>%password%</span> -e <span class=s2>"sql_qry"</span> --verbose --show-warnings
</code></pre></div><h2 id=dump-to-csv>dump to csv<a title="Permanent link" class=headerlink href=#dump-to-csv>¶</a></h2><p>LOAD DATA INFILE requires txt data path in the <strong>server data folder</strong>\ LOAD DATA LOCAL INFILE is slower as a copy has to be made to the server disk<div class=highlight><pre><span></span><code><a href=#__codelineno-7-1 id=__codelineno-7-1 name=__codelineno-7-1></a>mysqldump -h host -P port -u user -ppass --tab=/dir mydb mytable
<a href=#__codelineno-7-2 id=__codelineno-7-2 name=__codelineno-7-2></a>mysqldump --tab=/tmp --fields-terminated-by=, --fields-enclosed-by='<span class=s2>"' --lines-terminated-by=0x0d0a db1</span>
<a href=#__codelineno-7-3 id=__codelineno-7-3 name=__codelineno-7-3></a>$ mysql -h localhost -u root -p
<a href=#__codelineno-7-4 id=__codelineno-7-4 name=__codelineno-7-4></a>mysql<span class=p>></span> LOAD DATA INFILE '/tmp/mytable.txt' INTO TABLE mytable;
<a href=#__codelineno-7-5 id=__codelineno-7-5 name=__codelineno-7-5></a>
<a href=#__codelineno-7-6 id=__codelineno-7-6 name=__codelineno-7-6></a>LOAD DATA INFILE 'E:\\wamp\\tmp\\customer.csv' INTO TABLE customer
<a href=#__codelineno-7-7 id=__codelineno-7-7 name=__codelineno-7-7></a>CHARACTER SET 'utf8'
<a href=#__codelineno-7-8 id=__codelineno-7-8 name=__codelineno-7-8></a>FIELDS TERMINATED BY ',' ENCLOSED BY '<span class=s2>"'</span>
<a href=#__codelineno-7-9 id=__codelineno-7-9 name=__codelineno-7-9></a>LINES TERMINATED BY '\r\n'
<a href=#__codelineno-7-10 id=__codelineno-7-10 name=__codelineno-7-10></a>IGNORE 1 LINES;
</code></pre></div><p>This does not work in windows:<div class=highlight><pre><span></span><code><a href=#__codelineno-8-1 id=__codelineno-8-1 name=__codelineno-8-1></a>mysqldump<span class=w> </span>--defaults-extra-file<span class=o>=</span>D:<span class=se>\s</span>qlbackup<span class=se>\s</span>qlsvr.cnf<span class=w> </span>--tab<span class=o>=</span><span class=s2>"D:\sqlbackup\dump_files"</span><span class=w> </span>db<span class=w> </span>tb<span class=w> </span>--fields-terminated-by<span class=o>=</span><span class=s1>','</span><span class=w> </span>--fields-optionally-enclosed-by<span class=o>=</span><span class=s1>'"'</span><span class=w> </span>--fields-escaped-by<span class=o>=</span><span class=s1>'\'</span><span class=w> </span>--lines-terminated-by<span class=o>=</span><span class=s1>'\n'</span>
</code></pre></div> Must use hex in windows <div class=highlight><pre><span></span><code><a href=#__codelineno-9-1 id=__codelineno-9-1 name=__codelineno-9-1></a>mysqldump<span class=w> </span>--defaults-extra-file<span class=o>=</span>D:<span class=se>\s</span>qlbackup<span class=se>\s</span>qlsvr.cnf<span class=w> </span>--tab<span class=o>=</span><span class=s2>"D:\sqlbackup\dump_files"</span><span class=w> </span>db<span class=w> </span>tb<span class=w> </span>--fields-terminated-by<span class=o>=</span>0x2C<span class=w> </span>--fields-optionally-enclosed-by<span class=o>=</span>0x22<span class=w> </span>--fields-escaped-by<span class=o>=</span>0x5C<span class=w> </span>--lines-terminated-by<span class=o>=</span>0x0a
</code></pre></div><h2 id=dump-db-with-each-table-in-a-separate-file>dump db with each table in a separate file<a title="Permanent link" class=headerlink href=#dump-db-with-each-table-in-a-separate-file>¶</a></h2><p>redirect the query to another database<div class=highlight><pre><span></span><code><a href=#__codelineno-10-1 id=__codelineno-10-1 name=__codelineno-10-1></a><span class=ch>#!/bin/bash</span>
<a href=#__codelineno-10-2 id=__codelineno-10-2 name=__codelineno-10-2></a>
<a href=#__codelineno-10-3 id=__codelineno-10-3 name=__codelineno-10-3></a><span class=nv>fdb</span><span class=o>=</span>dump_dbs.txt
<a href=#__codelineno-10-4 id=__codelineno-10-4 name=__codelineno-10-4></a><span class=nv>dir</span><span class=o>=</span><span class=s2>"/media/data/test"</span>
<a href=#__codelineno-10-5 id=__codelineno-10-5 name=__codelineno-10-5></a><span class=nv>typ</span><span class=o>=</span><span class=s2>"BASE TABLE"</span>
<a href=#__codelineno-10-6 id=__codelineno-10-6 name=__codelineno-10-6></a>
<a href=#__codelineno-10-7 id=__codelineno-10-7 name=__codelineno-10-7></a><span class=nv>create_list</span><span class=o>=</span><span class=k>$((</span><span class=w> </span><span class=nv>$#</span><span class=o>==</span><span class=m>0</span><span class=w> </span>?<span class=w> </span><span class=m>1</span><span class=w> </span>:<span class=w> </span><span class=m>0</span><span class=w> </span><span class=k>))</span>
<a href=#__codelineno-10-8 id=__codelineno-10-8 name=__codelineno-10-8></a>
<a href=#__codelineno-10-9 id=__codelineno-10-9 name=__codelineno-10-9></a>timestamp<span class=o>()</span><span class=w> </span><span class=o>{</span>
<a href=#__codelineno-10-10 id=__codelineno-10-10 name=__codelineno-10-10></a><span class=w>    </span>date<span class=w> </span>+<span class=s2>"%Y-%m-%d %H:%M:%S"</span>
<a href=#__codelineno-10-11 id=__codelineno-10-11 name=__codelineno-10-11></a><span class=o>}</span>
<a href=#__codelineno-10-12 id=__codelineno-10-12 name=__codelineno-10-12></a>
<a href=#__codelineno-10-13 id=__codelineno-10-13 name=__codelineno-10-13></a><span class=nv>i</span><span class=o>=</span><span class=m>0</span>
<a href=#__codelineno-10-14 id=__codelineno-10-14 name=__codelineno-10-14></a><span class=nb>echo</span><span class=w> </span><span class=k>$(</span>timestamp<span class=k>)</span><span class=w> </span>dump<span class=w> </span>dbs
<a href=#__codelineno-10-15 id=__codelineno-10-15 name=__codelineno-10-15></a><span class=k>while</span><span class=w> </span><span class=nb>read</span><span class=w> </span>db<span class=p>;</span><span class=w> </span><span class=k>do</span>
<a href=#__codelineno-10-16 id=__codelineno-10-16 name=__codelineno-10-16></a><span class=w>    </span><span class=o>((</span>++i<span class=o>))</span>
<a href=#__codelineno-10-17 id=__codelineno-10-17 name=__codelineno-10-17></a><span class=w>    </span><span class=nv>ftb</span><span class=o>=</span><span class=nv>$dir</span>/<span class=nv>$db</span><span class=s2>"_tbs.txt"</span>
<a href=#__codelineno-10-18 id=__codelineno-10-18 name=__codelineno-10-18></a><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=o>[</span><span class=w> </span><span class=nv>$create_list</span><span class=w> </span>-eq<span class=w> </span><span class=m>1</span><span class=w> </span><span class=o>]</span><span class=p>;</span><span class=w> </span><span class=k>then</span>
<a href=#__codelineno-10-19 id=__codelineno-10-19 name=__codelineno-10-19></a><span class=w>    </span><span class=nv>qry</span><span class=o>=</span><span class=s1>'SELECT table_name FROM information_schema.tables WHERE table_schema='</span><span class=se>\'</span><span class=si>${</span><span class=nv>db</span><span class=si>}</span><span class=se>\'</span><span class=s1>' and table_type='</span><span class=se>\'</span><span class=si>${</span><span class=nv>typ</span><span class=si>}</span><span class=se>\'</span><span class=s1>' order by data_length asc;'</span>
<a href=#__codelineno-10-20 id=__codelineno-10-20 name=__codelineno-10-20></a><span class=w>        </span>mysql<span class=w> </span>--defaults-extra-file<span class=o>=</span><span class=nv>$dir</span>/svr_fr.cnf<span class=w> </span>--skip-column-names<span class=w> </span>-e<span class=w> </span><span class=s2>"</span><span class=si>${</span><span class=nv>qry</span><span class=si>}</span><span class=s2>"</span><span class=w> </span>><span class=nv>$ftb</span>
<a href=#__codelineno-10-21 id=__codelineno-10-21 name=__codelineno-10-21></a><span class=w>    </span><span class=k>fi</span>
<a href=#__codelineno-10-22 id=__codelineno-10-22 name=__codelineno-10-22></a><span class=w>    </span><span class=nb>echo</span><span class=w> </span><span class=k>$(</span>timestamp<span class=k>)</span><span class=w> </span><span class=s2>"  "</span><span class=w> </span>db:<span class=w> </span><span class=nv>$db</span>
<a href=#__codelineno-10-23 id=__codelineno-10-23 name=__codelineno-10-23></a><span class=w>    </span><span class=nv>j</span><span class=o>=</span><span class=m>0</span>
<a href=#__codelineno-10-24 id=__codelineno-10-24 name=__codelineno-10-24></a><span class=w>    </span><span class=k>while</span><span class=w> </span><span class=nb>read</span><span class=w> </span>tb<span class=p>;</span><span class=w> </span><span class=k>do</span>
<a href=#__codelineno-10-25 id=__codelineno-10-25 name=__codelineno-10-25></a><span class=w>        </span><span class=o>((</span>++j<span class=o>))</span>
<a href=#__codelineno-10-26 id=__codelineno-10-26 name=__codelineno-10-26></a><span class=w>        </span><span class=nb>echo</span><span class=w> </span><span class=k>$(</span>timestamp<span class=k>)</span><span class=w> </span><span class=s2>"    "</span><span class=nv>$j</span><span class=w> </span>table:<span class=w> </span><span class=nv>$tb</span>
<a href=#__codelineno-10-27 id=__codelineno-10-27 name=__codelineno-10-27></a><span class=w>        </span>mysqldump<span class=w> </span>--defaults-extra-file<span class=o>=</span><span class=nv>$dir</span>/svr_fr.cnf<span class=w> </span><span class=nv>$db</span><span class=w> </span><span class=nv>$tb</span><span class=w> </span><span class=p>|</span><span class=w> </span>mysql<span class=w> </span>--defaults-extra-file<span class=o>=</span><span class=nv>$dir</span>/svr_to.cnf<span class=w> </span><span class=nv>$db</span>
<a href=#__codelineno-10-28 id=__codelineno-10-28 name=__codelineno-10-28></a><span class=w>    </span><span class=k>done</span><span class=w> </span>&lt;<span class=nv>$ftb</span>
<a href=#__codelineno-10-29 id=__codelineno-10-29 name=__codelineno-10-29></a><span class=k>done</span><span class=w> </span>&lt;<span class=nv>$fdb</span>
<a href=#__codelineno-10-30 id=__codelineno-10-30 name=__codelineno-10-30></a>
<a href=#__codelineno-10-31 id=__codelineno-10-31 name=__codelineno-10-31></a><span class=nb>echo</span><span class=w> </span><span class=k>$(</span>timestamp<span class=k>)</span><span class=w> </span>all<span class=w> </span><span class=k>done</span>!
</code></pre></div><h2 id=dump-db-with-each-table-in-a-separate-file_1>dump db with each table in a separate file<a title="Permanent link" class=headerlink href=#dump-db-with-each-table-in-a-separate-file_1>¶</a></h2><div class=highlight><pre><span></span><code><a href=#__codelineno-11-1 id=__codelineno-11-1 name=__codelineno-11-1></a><span class=ch>#!/bin/bash</span>
<a href=#__codelineno-11-2 id=__codelineno-11-2 name=__codelineno-11-2></a>
<a href=#__codelineno-11-3 id=__codelineno-11-3 name=__codelineno-11-3></a><span class=nv>fdb</span><span class=o>=</span>fdt_dbs.txt
<a href=#__codelineno-11-4 id=__codelineno-11-4 name=__codelineno-11-4></a><span class=nv>dir</span><span class=o>=</span><span class=s2>"/media/data/test"</span>
<a href=#__codelineno-11-5 id=__codelineno-11-5 name=__codelineno-11-5></a><span class=nv>op1</span><span class=o>=</span><span class=s2>"--tab=</span><span class=nv>$dir</span><span class=s2>"</span>
<a href=#__codelineno-11-6 id=__codelineno-11-6 name=__codelineno-11-6></a><span class=nv>op2</span><span class=o>=</span><span class=s2>" --default-character-set=latin1 --fields-terminated-by=\t --lines-terminated-by=\r\n"</span>
<a href=#__codelineno-11-7 id=__codelineno-11-7 name=__codelineno-11-7></a>
<a href=#__codelineno-11-8 id=__codelineno-11-8 name=__codelineno-11-8></a><span class=nv>create_list</span><span class=o>=</span><span class=k>$((</span><span class=w> </span><span class=nv>$#</span><span class=o>==</span><span class=m>0</span><span class=w> </span>?<span class=w> </span><span class=m>1</span><span class=w> </span>:<span class=w> </span><span class=m>0</span><span class=w> </span><span class=k>))</span>
<a href=#__codelineno-11-9 id=__codelineno-11-9 name=__codelineno-11-9></a>
<a href=#__codelineno-11-10 id=__codelineno-11-10 name=__codelineno-11-10></a>timestamp<span class=o>()</span><span class=w> </span><span class=o>{</span>
<a href=#__codelineno-11-11 id=__codelineno-11-11 name=__codelineno-11-11></a><span class=w>  </span>date<span class=w> </span>+<span class=s2>"%Y-%m-%d %H:%M:%S"</span>
<a href=#__codelineno-11-12 id=__codelineno-11-12 name=__codelineno-11-12></a><span class=o>}</span>
<a href=#__codelineno-11-13 id=__codelineno-11-13 name=__codelineno-11-13></a>
<a href=#__codelineno-11-14 id=__codelineno-11-14 name=__codelineno-11-14></a><span class=nb>echo</span><span class=w> </span><span class=k>$(</span>timestamp<span class=k>)</span><span class=w> </span>dump<span class=w> </span>dbs
<a href=#__codelineno-11-15 id=__codelineno-11-15 name=__codelineno-11-15></a><span class=nv>i</span><span class=o>=</span><span class=m>0</span>
<a href=#__codelineno-11-16 id=__codelineno-11-16 name=__codelineno-11-16></a><span class=k>while</span><span class=w> </span><span class=nb>read</span><span class=w> </span>db<span class=p>;</span><span class=w> </span><span class=k>do</span>
<a href=#__codelineno-11-17 id=__codelineno-11-17 name=__codelineno-11-17></a><span class=w>    </span><span class=o>((</span>++i<span class=o>))</span>
<a href=#__codelineno-11-18 id=__codelineno-11-18 name=__codelineno-11-18></a><span class=w>    </span><span class=nv>ftb</span><span class=o>=</span><span class=nv>$dir</span>/<span class=nv>$db</span><span class=s2>"_tbs.txt"</span>
<a href=#__codelineno-11-19 id=__codelineno-11-19 name=__codelineno-11-19></a><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=o>[</span><span class=w> </span><span class=nv>$create_list</span><span class=w> </span>-eq<span class=w> </span><span class=m>1</span><span class=w> </span><span class=o>]</span><span class=p>;</span><span class=w> </span><span class=k>then</span>
<a href=#__codelineno-11-20 id=__codelineno-11-20 name=__codelineno-11-20></a><span class=w>        </span><span class=nv>qry</span><span class=o>=</span><span class=s1>'select table_name from information_schema.tables where table_schema='</span><span class=se>\'</span><span class=si>${</span><span class=nv>db</span><span class=si>}</span><span class=se>\'</span><span class=s1>' order by table_name;'</span>
<a href=#__codelineno-11-21 id=__codelineno-11-21 name=__codelineno-11-21></a><span class=w>        </span>mysql<span class=w> </span>--defaults-extra-file<span class=o>=</span><span class=nv>$dir</span>/sqlsvr.cnf<span class=w> </span>--skip-column-names<span class=w> </span>-e<span class=w> </span><span class=s2>"</span><span class=si>${</span><span class=nv>qry</span><span class=si>}</span><span class=s2>"</span><span class=w> </span>><span class=w> </span><span class=nv>$ftb</span>
<a href=#__codelineno-11-22 id=__codelineno-11-22 name=__codelineno-11-22></a><span class=w>    </span><span class=k>fi</span>
<a href=#__codelineno-11-23 id=__codelineno-11-23 name=__codelineno-11-23></a><span class=w>    </span><span class=nb>echo</span><span class=w> </span><span class=k>$(</span>timestamp<span class=k>)</span><span class=w> </span><span class=s2>"  "</span><span class=w> </span>db:<span class=w> </span><span class=nv>$db</span>
<a href=#__codelineno-11-24 id=__codelineno-11-24 name=__codelineno-11-24></a><span class=w>    </span><span class=nv>j</span><span class=o>=</span><span class=m>0</span>
<a href=#__codelineno-11-25 id=__codelineno-11-25 name=__codelineno-11-25></a><span class=w>    </span><span class=k>while</span><span class=w> </span><span class=nb>read</span><span class=w> </span>tb<span class=p>;</span><span class=w> </span><span class=k>do</span>
<a href=#__codelineno-11-26 id=__codelineno-11-26 name=__codelineno-11-26></a><span class=w>        </span><span class=o>((</span>++j<span class=o>))</span>
<a href=#__codelineno-11-27 id=__codelineno-11-27 name=__codelineno-11-27></a><span class=w>        </span><span class=nb>echo</span><span class=w> </span><span class=k>$(</span>timestamp<span class=k>)</span><span class=w> </span><span class=s2>"    "</span><span class=nv>$j</span><span class=w> </span>table:<span class=w> </span><span class=nv>$tb</span>
<a href=#__codelineno-11-28 id=__codelineno-11-28 name=__codelineno-11-28></a><span class=w>        </span>mysqldump<span class=w> </span>--defaults-extra-file<span class=o>=</span><span class=nv>$dir</span>/sqlsvr.cnf<span class=w> </span><span class=nv>$op1</span><span class=w> </span><span class=nv>$op2</span><span class=w> </span><span class=nv>$db</span><span class=w> </span><span class=nv>$tb</span>
<a href=#__codelineno-11-29 id=__codelineno-11-29 name=__codelineno-11-29></a><span class=w>        </span>mv<span class=w> </span><span class=nv>$tb</span><span class=s2>".sql"</span><span class=w> </span><span class=nv>$db</span><span class=s2>"_"</span><span class=nv>$tb</span><span class=s2>".sql"</span>
<a href=#__codelineno-11-30 id=__codelineno-11-30 name=__codelineno-11-30></a><span class=w>        </span>mv<span class=w> </span><span class=nv>$tb</span><span class=s2>".txt"</span><span class=w> </span><span class=nv>$db</span><span class=s2>"_"</span><span class=nv>$tb</span><span class=s2>".txt"</span>
<a href=#__codelineno-11-31 id=__codelineno-11-31 name=__codelineno-11-31></a><span class=w>    </span><span class=k>done</span><span class=w> </span>&lt;<span class=nv>$ftb</span>
<a href=#__codelineno-11-32 id=__codelineno-11-32 name=__codelineno-11-32></a><span class=k>done</span><span class=w> </span>&lt;<span class=nv>$fdb</span>
<a href=#__codelineno-11-33 id=__codelineno-11-33 name=__codelineno-11-33></a>
<a href=#__codelineno-11-34 id=__codelineno-11-34 name=__codelineno-11-34></a><span class=nb>echo</span><span class=w> </span><span class=k>$(</span>timestamp<span class=k>)</span><span class=w> </span>all<span class=w> </span><span class=k>done</span>!
</code></pre></div><h2 id=dump-db-with-each-table-in-a-separate-file_2>dump db with each table in a separate file<a title="Permanent link" class=headerlink href=#dump-db-with-each-table-in-a-separate-file_2>¶</a></h2><div class=highlight><pre><span></span><code><a href=#__codelineno-12-1 id=__codelineno-12-1 name=__codelineno-12-1></a><span class=p>@</span><span class=k>echo</span> off
<a href=#__codelineno-12-2 id=__codelineno-12-2 name=__codelineno-12-2></a>
<a href=#__codelineno-12-3 id=__codelineno-12-3 name=__codelineno-12-3></a><span class=k>setlocal</span> EnableDelayedExpansion
<a href=#__codelineno-12-4 id=__codelineno-12-4 name=__codelineno-12-4></a>
<a href=#__codelineno-12-5 id=__codelineno-12-5 name=__codelineno-12-5></a><span class=k>set</span> <span class=nv>fdb</span><span class=p>=</span>fdt_dbs.txt
<a href=#__codelineno-12-6 id=__codelineno-12-6 name=__codelineno-12-6></a><span class=k>set</span> <span class=nv>dirwd</span><span class=p>=</span><span class=nv>%~dp0</span>
<a href=#__codelineno-12-7 id=__codelineno-12-7 name=__codelineno-12-7></a><span class=k>set</span> <span class=nv>dirwn</span><span class=p>=</span>C:\ProgramData\MySQL\MySQL Server 8.0\Data\#dump_tmp
<a href=#__codelineno-12-8 id=__codelineno-12-8 name=__codelineno-12-8></a><span class=k>set</span> <span class=nv>dirto</span><span class=p>=</span><span class=nv>%dirwn:\=/%</span>
<a href=#__codelineno-12-9 id=__codelineno-12-9 name=__codelineno-12-9></a><span class=k>set</span> <span class=nv>dirfr</span><span class=p>=</span>\\sql.server\test
<a href=#__codelineno-12-10 id=__codelineno-12-10 name=__codelineno-12-10></a><span class=k>set</span> <span class=nv>par</span><span class=p>=</span>CHARACTER SET latin1 FIELDS TERMINATED BY '\t' LINES TERMINATED BY '\r\n';
<a href=#__codelineno-12-11 id=__codelineno-12-11 name=__codelineno-12-11></a>
<a href=#__codelineno-12-12 id=__codelineno-12-12 name=__codelineno-12-12></a><span class=c1>rem net use "\\sql.server" pwd /user:workgroup\usr</span>
<a href=#__codelineno-12-13 id=__codelineno-12-13 name=__codelineno-12-13></a>
<a href=#__codelineno-12-14 id=__codelineno-12-14 name=__codelineno-12-14></a><span class=k>echo</span> <span class=nv>%dirto%</span>/<span class=nv>%fdb%</span>
<a href=#__codelineno-12-15 id=__codelineno-12-15 name=__codelineno-12-15></a>
<a href=#__codelineno-12-16 id=__codelineno-12-16 name=__codelineno-12-16></a><span class=k>echo</span> <span class=nv>%date%</span> <span class=nv>%time%</span> load dbs
<a href=#__codelineno-12-17 id=__codelineno-12-17 name=__codelineno-12-17></a><span class=c1>rem copy /z %dirfr%\%fdb% %dirto%\%fdb%</span>
<a href=#__codelineno-12-18 id=__codelineno-12-18 name=__codelineno-12-18></a><span class=k>set</span> <span class=nv>i</span><span class=p>=</span>0
<a href=#__codelineno-12-19 id=__codelineno-12-19 name=__codelineno-12-19></a><span class=k>for</span> <span class=k>/f</span> <span class=s2>"usebackq"</span> <span class=se>%%</span>a <span class=k>in</span> <span class=p>(</span><span class=s2>"</span><span class=nv>%dirto%</span><span class=s2>/</span><span class=nv>%fdb%</span><span class=s2>"</span><span class=p>)</span> <span class=k>do</span> <span class=p>(</span>
<a href=#__codelineno-12-20 id=__codelineno-12-20 name=__codelineno-12-20></a>    <span class=k>set</span> <span class=k>/a</span> <span class=nv>i</span><span class=o>=!</span><span class=nv>i</span><span class=o>!+</span><span class=mi>1</span>
<a href=#__codelineno-12-21 id=__codelineno-12-21 name=__codelineno-12-21></a>    <span class=k>echo</span> <span class=nv>!date!</span> <span class=nv>!time!</span>  <span class=nv>!i!</span> db: <span class=se>%%</span>a
<a href=#__codelineno-12-22 id=__codelineno-12-22 name=__codelineno-12-22></a>    <span class=c1>rem copy /z %dirfr%\%%a_tbs.txt %dirto%\%%a%_tbs.txt</span>
<a href=#__codelineno-12-23 id=__codelineno-12-23 name=__codelineno-12-23></a>    <span class=k>set</span> <span class=nv>j</span><span class=p>=</span>0
<a href=#__codelineno-12-24 id=__codelineno-12-24 name=__codelineno-12-24></a>    <span class=k>for</span> <span class=k>/f</span> <span class=s2>"usebackq"</span> <span class=se>%%</span>b <span class=k>in</span> <span class=p>(</span><span class=s2>"</span><span class=nv>%dirto%</span><span class=s2>/</span><span class=se>%%</span><span class=s2>a_tbs.txt"</span><span class=p>)</span> <span class=k>do</span> <span class=p>(</span>
<a href=#__codelineno-12-25 id=__codelineno-12-25 name=__codelineno-12-25></a>        <span class=k>set</span> <span class=k>/a</span> <span class=nv>j</span><span class=o>=!</span><span class=nv>j</span><span class=o>!+</span><span class=mi>1</span>
<a href=#__codelineno-12-26 id=__codelineno-12-26 name=__codelineno-12-26></a>        <span class=k>echo</span> <span class=nv>!date!</span> <span class=nv>!time!</span>    <span class=nv>!j!</span> table: <span class=se>%%</span>b
<a href=#__codelineno-12-27 id=__codelineno-12-27 name=__codelineno-12-27></a>        <span class=c1>rem copy /z %dirfr%\%%a_%%b.sql %dirto%\%%a_%%b.sql</span>
<a href=#__codelineno-12-28 id=__codelineno-12-28 name=__codelineno-12-28></a>        mysql --defaults-extra-file=<span class=nv>%dirwd%</span>svr_to.cnf <span class=se>%%</span>a <span class=p>&lt;</span> <span class=s2>"</span><span class=nv>%dirto%</span><span class=s2>/</span><span class=se>%%</span><span class=s2>a_</span><span class=se>%%</span><span class=s2>b.sql"</span>
<a href=#__codelineno-12-29 id=__codelineno-12-29 name=__codelineno-12-29></a>        <span class=c1>rem copy /z %dirfr%\%%a_%%b.txt %dirto%\%%a_%%b.txt</span>
<a href=#__codelineno-12-30 id=__codelineno-12-30 name=__codelineno-12-30></a>        <span class=k>set</span> <span class=nv>sql_qry</span><span class=p>=</span>USE <span class=se>%%</span>a;LOAD DATA INFILE '!dirto!/<span class=se>%%</span>a_<span class=se>%%</span>b.txt' INTO TABLE <span class=se>%%</span>b <span class=nv>%par%</span>
<a href=#__codelineno-12-31 id=__codelineno-12-31 name=__codelineno-12-31></a>        mysql --defaults-extra-file=<span class=nv>%dirwd%</span>sql_server.cnf -e <span class=s2>"</span><span class=nv>!sql_qry!</span><span class=s2>"</span> --show-warnings
<a href=#__codelineno-12-32 id=__codelineno-12-32 name=__codelineno-12-32></a>    <span class=p>)</span>
<a href=#__codelineno-12-33 id=__codelineno-12-33 name=__codelineno-12-33></a><span class=p>)</span>
<a href=#__codelineno-12-34 id=__codelineno-12-34 name=__codelineno-12-34></a>
<a href=#__codelineno-12-35 id=__codelineno-12-35 name=__codelineno-12-35></a><span class=c1>rem net use "\\xx-xx.xx.xx" /delete</span>
<a href=#__codelineno-12-36 id=__codelineno-12-36 name=__codelineno-12-36></a>
<a href=#__codelineno-12-37 id=__codelineno-12-37 name=__codelineno-12-37></a><span class=k>echo</span> <span class=nv>%date%</span> <span class=nv>%time%</span> all done!
</code></pre></div><h2 id=disbale-key-checking>disbale key checking<a title="Permanent link" class=headerlink href=#disbale-key-checking>¶</a></h2><p>It sounds like your import is slowing down--processing fewer rows per second--as it progresses. That probably means MySQL is checking each new row to see whether it has key-conflicts with the rows already inserted.<p>A few things you can do:<p>Before starting, disable key checking: SET FOREIGN_KEY_CHECKS = 0; SET UNIQUE_CHECKS = 0;<p>After ending restore your key checking: SET UNIQUE_CHECKS = 1; SET FOREIGN_KEY_CHECKS = 1;<p>mysqldump can be made to create a dump with that disables keys:\ mysqldump --disable-keys Similarly, mysqldump --extended-insert --no-autocommit will make the dumped sql file contain a variant of my suggestion about using transactions.<p>https://dev.mysql.com/doc/refman/5.7/en/mysqldump.html#option_mysqldump_disable-keys<p>For each table, surround the INSERT statements with /<em>!40000 ALTER TABLE tbl_name DISABLE KEYS </em>/; and /<em>!40000 ALTER TABLE tbl_name ENABLE KEYS </em>/; statements. This makes loading the dump file faster because the indexes are created after all rows are inserted. This option is effective only for nonunique indexes of <strong>MyISAM</strong> tables. By default, the key checking is disabled.</article></div><script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script></div><button class="md-top md-icon" data-md-component=top hidden type=button><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top</button></main><footer class=md-footer><div class="md-footer-meta md-typeset"><div class="md-footer-meta__inner md-grid"><div class=md-copyright><div class=md-copyright__highlight><a title="Go to Main Home Page" href=/>🏠 Back to Home</a><br> Copyright © 2026 Sean Ma <br>Last updated on <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-custom" title="January 3, 2024 11:06:42 UTC">3 Jan 2024</span></div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ rel=noopener target=_blank> Material for MkDocs </a></div></div></div></footer></div><div class=md-dialog data-md-component=dialog><div class="md-dialog__inner md-typeset"></div></div><script id=__config type=application/json>{"base": "../../..", "features": ["navigation.tabs", "navigation.expand", "navigation.indexes", "navigation.top", "toc.follow", "search.suggest", "search.highlight", "content.code.copy", "navigation.prune"], "search": "../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script><script src=../../../assets/javascripts/bundle.56ea9cef.min.js></script>