<!doctype html><html class=no-js lang=en><meta charset=utf-8><meta content="width=device-width,initial-scale=1" name=viewport><link href=https://seanslma.github.io/maki/Python/Blog/ReadCSVPerf/ rel=canonical><link href=../PandasTestDataFrame/ rel=prev><link href=../ReadExcelPerf/ rel=next><link href=../../../assets/images/favicon.png rel=icon><meta content="mkdocs-1.6.1, mkdocs-material-9.6.15" name=generator><title>Read CSV Files 10x to 40x Faster Using pyarrow and polars - maki</title><link href=../../../assets/stylesheets/main.342714a4.min.css rel=stylesheet><link href=../../../assets/stylesheets/palette.06af60db.min.css rel=stylesheet><link crossorigin href=https://fonts.gstatic.com rel=preconnect><link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback" rel=stylesheet><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link href=../../../stylesheets/extra.css rel=stylesheet><script>__md_scope=new URL(`../../..`,location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+`.`+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+`.`+e,JSON.stringify(_))}catch{}};</script><body data-md-color-accent=indigo data-md-color-primary=indigo data-md-color-scheme=default dir=ltr><input autocomplete=off class=md-toggle data-md-toggle=drawer id=__drawer type=checkbox><input autocomplete=off class=md-toggle data-md-toggle=search id=__search type=checkbox><label class=md-overlay for=__drawer></label><div data-md-component=skip><a class=md-skip href=#read-csv-files-10x-to-40x-faster-using-pyarrow-and-polars> Skip to content </a></div><div data-md-component=announce></div><header class=md-header data-md-component=header><nav class="md-header__inner md-grid" aria-label=Header><a class="md-header__button md-logo" aria-label=maki data-md-component=logo href=../../.. title=maki> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a><label class="md-header__button md-icon" for=__drawer><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg></label><div class=md-header__title data-md-component=header-title><div class=md-header__ellipsis><div class=md-header__topic><span class=md-ellipsis> maki </span></div><div class=md-header__topic data-md-component=header-topic><span class=md-ellipsis> Read CSV Files 10x to 40x Faster Using pyarrow and polars </span></div></div></div><form class=md-header__option data-md-component=palette><input aria-label="Switch to dark mode" class=md-option data-md-color-accent=indigo data-md-color-media data-md-color-primary=indigo data-md-color-scheme=default id=__palette_0 name=__palette type=radio><label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg></label><input aria-label="Switch to light mode" class=md-option data-md-color-accent=indigo data-md-color-media data-md-color-primary=indigo data-md-color-scheme=slate id=__palette_1 name=__palette type=radio><label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg></label></form><script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script><label class="md-header__button md-icon" for=__search><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg></label><div class=md-search data-md-component=search role=dialog><label class=md-search__overlay for=__search></label><div class=md-search__inner role=search><form class=md-search__form name=search><input aria-label=Search autocapitalize=off autocomplete=off autocorrect=off class=md-search__input data-md-component=search-query name=query placeholder=Search required spellcheck=false><label class="md-search__icon md-icon" for=__search><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg></label><nav aria-label=Search class=md-search__options><button class="md-search__icon md-icon" aria-label=Clear tabindex=-1 title=Clear type=reset><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg></button></nav><div class=md-search__suggest data-md-component=search-suggest></div></form><div class=md-search__output><div class=md-search__scrollwrap data-md-scrollfix tabindex=0><div class=md-search-result data-md-component=search-result><div class=md-search-result__meta>Initializing search</div><ol class=md-search-result__list role=presentation></ol></div></div></div></div></div><div class=md-header__source><a title="Go to repository" class=md-source data-md-component=source href=https://github.com/seanslma/maki> <div class="md-source__icon md-icon"><svg viewbox="0 0 448 512" xmlns=http://www.w3.org/2000/svg><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg></div> <div class=md-source__repository>GitHub</div> </a></div></nav></header><div class=md-container data-md-component=container><nav aria-label=Tabs class=md-tabs data-md-component=tabs><div class=md-grid><ul class=md-tabs__list><li class=md-tabs__item><a class=md-tabs__link href=../../..> About </a><li class=md-tabs__item><a class=md-tabs__link href=../../../AI/ChatGPT/> AI </a><li class=md-tabs__item><a class=md-tabs__link href=../../../AWS/CDN/> AWS </a><li class=md-tabs__item><a class=md-tabs__link href=../../../Azure/Advisor/> Azure </a><li class=md-tabs__item><a class=md-tabs__link href=../../../Coding/Notepad%2B%2B/> Coding </a><li class=md-tabs__item><a class=md-tabs__link href=../../../Cybersecurity/Cybersecurity/> Cybersecurity </a><li class=md-tabs__item><a class=md-tabs__link href=../../../Data/Data/> Data </a><li class=md-tabs__item><a class=md-tabs__link href=../../../DevOps/DevOps/> DevOps </a><li class=md-tabs__item><a class=md-tabs__link href=../../../Documentation/Jira/> Documentation </a><li class=md-tabs__item><a class=md-tabs__link href=../../../Energy/Inertia/> Energy </a><li class=md-tabs__item><a class=md-tabs__link href=../../../Learn/Book/> Learn </a><li class=md-tabs__item><a class=md-tabs__link href=../../../ML/Backtest/> ML </a><li class=md-tabs__item><a class=md-tabs__link href=../../../Optimizaton/Convex/> Optimizaton </a><li class=md-tabs__item><a class=md-tabs__link href=../../../PowerBI/Basic/> PowerBI </a><li class="md-tabs__item md-tabs__item--active"><a class=md-tabs__link href=../../NAN/> Python </a><li class=md-tabs__item><a class=md-tabs__link href=../../../SQL/Database/> SQL </a><li class=md-tabs__item><a class=md-tabs__link href=../../../System/Behavior/> System </a></ul></div></nav><main class=md-main data-md-component=main><div class="md-main__inner md-grid"><div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation><div class=md-sidebar__scrollwrap><div class=md-sidebar__inner><nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0><label class=md-nav__title for=__drawer><a class="md-nav__button md-logo" aria-label=maki data-md-component=logo href=../../.. title=maki> <svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> maki</label><div class=md-nav__source><a title="Go to repository" class=md-source data-md-component=source href=https://github.com/seanslma/maki> <div class="md-source__icon md-icon"><svg viewbox="0 0 448 512" xmlns=http://www.w3.org/2000/svg><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg></div> <div class=md-source__repository>GitHub</div> </a></div><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../..> <span class=md-ellipsis> About </span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../../AI/ChatGPT/> <span class=md-ellipsis> AI </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../../AWS/CDN/> <span class=md-ellipsis> AWS </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../../Azure/Advisor/> <span class=md-ellipsis> Azure </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../../Coding/Notepad%2B%2B/> <span class=md-ellipsis> Coding </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../../Cybersecurity/Cybersecurity/> <span class=md-ellipsis> Cybersecurity </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../../Data/Data/> <span class=md-ellipsis> Data </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../../DevOps/DevOps/> <span class=md-ellipsis> DevOps </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../../Documentation/Jira/> <span class=md-ellipsis> Documentation </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../../Energy/Inertia/> <span class=md-ellipsis> Energy </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../../Learn/Book/> <span class=md-ellipsis> Learn </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../../ML/Backtest/> <span class=md-ellipsis> ML </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../../Optimizaton/Convex/> <span class=md-ellipsis> Optimizaton </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../../PowerBI/Basic/> <span class=md-ellipsis> PowerBI </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"><input class="md-nav__toggle md-toggle" checked id=__nav_15 type=checkbox> <label class=md-nav__link for=__nav_15 id=__nav_15_label><span class=md-ellipsis> Python </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=true aria-labelledby=__nav_15_label class=md-nav data-md-level=1><label class=md-nav__title for=__nav_15><span class="md-nav__icon md-icon"></span> Python</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../../NAN/> <span class=md-ellipsis> NaN </span> </a><li class=md-nav__item><a class=md-nav__link href=../../Python/> <span class=md-ellipsis> Python </span> </a><li class=md-nav__item><a class=md-nav__link href=../../basic/> <span class=md-ellipsis> basic </span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../API/API/> <span class=md-ellipsis> API </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../App/Module/> <span class=md-ellipsis> App </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../Architect/Decorator/> <span class=md-ellipsis> Architect </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../Async/Asyncio/> <span class=md-ellipsis> Async </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--active md-nav__item--nested"><input class="md-nav__toggle md-toggle" checked id=__nav_15_8 type=checkbox> <label class=md-nav__link for=__nav_15_8 id=__nav_15_8_label tabindex=0><span class=md-ellipsis> Blog </span> <span class="md-nav__icon md-icon"></span></label> <nav aria-expanded=true aria-labelledby=__nav_15_8_label class=md-nav data-md-level=2><label class=md-nav__title for=__nav_15_8><span class="md-nav__icon md-icon"></span> Blog</label><ul class=md-nav__list data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=../BestPractices/> <span class=md-ellipsis> Python Programing Bets Practice </span> </a><li class=md-nav__item><a class=md-nav__link href=../CachesinPython/> <span class=md-ellipsis> Caches used in Python </span> </a><li class=md-nav__item><a class=md-nav__link href=../GroupbyApplyPerf/> <span class=md-ellipsis> How I reduced a Python app run time from two hours to 20 seconds? </span> </a><li class=md-nav__item><a class=md-nav__link href=../NumbaPerf/> <span class=md-ellipsis> Make Python Loops 5x to 10x Faster Using Numba </span> </a><li class=md-nav__item><a class=md-nav__link href=../PackageManagement/> <span class=md-ellipsis> How to manage python package dependencies </span> </a><li class=md-nav__item><a class=md-nav__link href=../PandasExplodeDateRange/> <span class=md-ellipsis> How to explode date ranges in a Pandas DataFrame 30x faster </span> </a><li class=md-nav__item><a class=md-nav__link href=../PandasTestDataFrame/> <span class=md-ellipsis> How to create dummy Pandas DataFrames for testing </span> </a><li class="md-nav__item md-nav__item--active"><input class="md-nav__toggle md-toggle" id=__toc type=checkbox> <label class="md-nav__link md-nav__link--active" for=__toc><span class=md-ellipsis> Read CSV Files 10x to 40x Faster Using pyarrow and polars </span> <span class="md-nav__icon md-icon"></span></label> <a class="md-nav__link md-nav__link--active" href=./> <span class=md-ellipsis> Read CSV Files 10x to 40x Faster Using pyarrow and polars </span> </a> <nav aria-label="Table of contents" class="md-nav md-nav--secondary"><label class=md-nav__title for=__toc><span class="md-nav__icon md-icon"></span> Table of contents</label><ul class=md-nav__list data-md-component=toc data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=#creating-test-data> <span class=md-ellipsis> Creating test data </span> </a><li class=md-nav__item><a class=md-nav__link href=#reading-csv-files-using-pandas> <span class=md-ellipsis> Reading CSV files using pandas </span> </a><li class=md-nav__item><a class=md-nav__link href=#reading-csv-files-using-polars> <span class=md-ellipsis> Reading CSV files using polars </span> </a><li class=md-nav__item><a class=md-nav__link href=#reading-csv-files-using-pyarrowcsv> <span class=md-ellipsis> Reading CSV files using pyarrow.csv </span> </a><li class=md-nav__item><a class=md-nav__link href=#best-options-from-pandas-polars-and-pyarrow> <span class=md-ellipsis> Best options from pandas, polars, and pyarrow </span> </a></ul></nav><li class=md-nav__item><a class=md-nav__link href=../ReadExcelPerf/> <span class=md-ellipsis> Read Excel performance </span> </a><li class=md-nav__item><a class=md-nav__link href=../ReadParquetPerf/> <span class=md-ellipsis> Read parquet performance </span> </a><li class=md-nav__item><a class=md-nav__link href=../ReadSqlDataType/> <span class=md-ellipsis> The Pandas Function pd.read_sql Returns An Empty DataFrame Without Correct Data Types </span> </a><li class=md-nav__item><a class=md-nav__link href=../SqlSslSecurityLevel/> <span class=md-ellipsis> Login Timeout From Ubuntu 22.04 To SQL Server Database </span> </a></ul></nav><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../CLI/Click/> <span class=md-ellipsis> CLI </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../Cache/Aiocache/> <span class=md-ellipsis> Cache </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../Celery/Example/> <span class=md-ellipsis> Celery </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../Class/ClassMethod/> <span class=md-ellipsis> Class </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../Conda/Bashrc/> <span class=md-ellipsis> Conda </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../Dash/Callback/> <span class=md-ellipsis> Dash </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../Dask/Config/> <span class=md-ellipsis> Dask </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../DataType/Dictionary/> <span class=md-ellipsis> DataType </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../DateTime/Conversion/> <span class=md-ellipsis> DateTime </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../Django/Django/> <span class=md-ellipsis> Django </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../Email/ExchangeLib/> <span class=md-ellipsis> Email </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../Env/Env/> <span class=md-ellipsis> Env </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../ErrorHandling/Exception/> <span class=md-ellipsis> ErrorHandling </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../Excel/Excel/> <span class=md-ellipsis> Excel </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../Flask/Request/> <span class=md-ellipsis> Flask </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../Format/Black/> <span class=md-ellipsis> Format </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../Generator/Generator/> <span class=md-ellipsis> Generator </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../IO/AzureBlob/> <span class=md-ellipsis> IO </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../Issue/Main/> <span class=md-ellipsis> Issue </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../Jupyter/Dashboard/> <span class=md-ellipsis> Jupyter </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../Logging/AzureLibraries/> <span class=md-ellipsis> Logging </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../MSOffice/Access/> <span class=md-ellipsis> MSOffice </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../Math/Sparse/> <span class=md-ellipsis> Math </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../NumPy/LinearFit/> <span class=md-ellipsis> NumPy </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../Package/CondaBuild/> <span class=md-ellipsis> Package </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../Pandas/Advance/> <span class=md-ellipsis> Pandas </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../PandasUpgradeTest/Datetime/> <span class=md-ellipsis> PandasUpgradeTest </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../Parallel/Example/> <span class=md-ellipsis> Parallel </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../Performance/Deadlock/> <span class=md-ellipsis> Performance </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../Pip/Pip/> <span class=md-ellipsis> Pip </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../Polars/CSV/> <span class=md-ellipsis> Polars </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../PyArrow/CSV/> <span class=md-ellipsis> PyArrow </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../PySpark/Column/> <span class=md-ellipsis> PySpark </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../Pytorch/Install/> <span class=md-ellipsis> Pytorch </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../Regex/Regex/> <span class=md-ellipsis> Regex </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../SQL/ADBC/> <span class=md-ellipsis> SQL </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../SQLAlchemy/BindParam/> <span class=md-ellipsis> SQLAlchemy </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../SSL/Cert/> <span class=md-ellipsis> SSL </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../SciPy/SparseMatrix/> <span class=md-ellipsis> SciPy </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../Serialization/Benchmark/> <span class=md-ellipsis> Serialization </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../Tensorflow/Install/> <span class=md-ellipsis> Tensorflow </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../Test/Config/> <span class=md-ellipsis> Test </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../Typing/tips/> <span class=md-ellipsis> Typing </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../Visualization/Chart/> <span class=md-ellipsis> Visualization </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../Web/Cherrypy/> <span class=md-ellipsis> Web </span> <span class="md-nav__icon md-icon"></span> </a></ul></nav><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../../SQL/Database/> <span class=md-ellipsis> SQL </span> <span class="md-nav__icon md-icon"></span> </a><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a class=md-nav__link href=../../../System/Behavior/> <span class=md-ellipsis> System </span> <span class="md-nav__icon md-icon"></span> </a></ul></nav></div></div></div><div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc><div class=md-sidebar__scrollwrap><div class=md-sidebar__inner><nav aria-label="Table of contents" class="md-nav md-nav--secondary"><label class=md-nav__title for=__toc><span class="md-nav__icon md-icon"></span> Table of contents</label><ul class=md-nav__list data-md-component=toc data-md-scrollfix><li class=md-nav__item><a class=md-nav__link href=#creating-test-data> <span class=md-ellipsis> Creating test data </span> </a><li class=md-nav__item><a class=md-nav__link href=#reading-csv-files-using-pandas> <span class=md-ellipsis> Reading CSV files using pandas </span> </a><li class=md-nav__item><a class=md-nav__link href=#reading-csv-files-using-polars> <span class=md-ellipsis> Reading CSV files using polars </span> </a><li class=md-nav__item><a class=md-nav__link href=#reading-csv-files-using-pyarrowcsv> <span class=md-ellipsis> Reading CSV files using pyarrow.csv </span> </a><li class=md-nav__item><a class=md-nav__link href=#best-options-from-pandas-polars-and-pyarrow> <span class=md-ellipsis> Best options from pandas, polars, and pyarrow </span> </a></ul></nav></div></div></div><div class=md-content data-md-component=content><article class="md-content__inner md-typeset"><h1 id=read-csv-files-10x-to-40x-faster-using-pyarrow-and-polars>Read CSV Files 10x to 40x Faster Using pyarrow and polars<a title="Permanent link" class=headerlink href=#read-csv-files-10x-to-40x-faster-using-pyarrow-and-polars>¶</a></h1><p>CSV (comma-separated values) files have been widely used in different areas. They can be easily exported from almost all programming languages. They can also be loaded into all text editors and many other applications. However, the main disadvantage is that CSV files are usually larger than files with other formats and it is slow to load them into memory.<p>Here we compare different options for reading CSV files by using the <code>pandas</code>, <code>polars</code> and <code>pyarrow</code> Python packages. We test the loading performance for CSV files each with a different data type. Based on the test results, we should be able to determine which option to use when we need reading CSV files faster.<h2 id=creating-test-data>Creating test data<a title="Permanent link" class=headerlink href=#creating-test-data>¶</a></h2><p>CSV files with three data types, <code>string</code>, <code>float</code>, and <code>datetime</code>, have been used to test the file reading performance. All the testing CSV files were created using the scripts in <a href=https://medium.com/@sean.lma/how-to-create-dummy-pandas-dataframes-for-testing-cf03c52878e3>my previous post</a>; each CSV file has 10 million rows and three columns with the same data type and a size of about 500 MB.<p>The <code>string</code> type CSV file was created with:<div class=highlight><pre><span></span><code><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a><span class=n>df_str</span> <span class=o>=</span> <span class=n>gen_rand_df</span><span class=p>(</span>
<a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=n>nrow</span><span class=o>=</span><span class=mi>10000000</span><span class=p>,</span>
<a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a>    <span class=n>str_cols</span><span class=o>=</span><span class=p>{</span>
<a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a>        <span class=s1>'count'</span><span class=p>:</span> <span class=mi>3</span><span class=p>,</span>
<a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a>        <span class=s1>'name'</span><span class=p>:</span> <span class=p>[</span><span class=s1>'c1'</span><span class=p>,</span> <span class=s1>'c2'</span><span class=p>,</span> <span class=s1>'c3'</span><span class=p>],</span>
<a href=#__codelineno-0-6 id=__codelineno-0-6 name=__codelineno-0-6></a>        <span class=s1>'str_len'</span><span class=p>:</span> <span class=p>[</span><span class=mi>10</span><span class=p>,</span> <span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=mi>15</span><span class=p>),</span> <span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=mi>50</span><span class=p>)],</span>
<a href=#__codelineno-0-7 id=__codelineno-0-7 name=__codelineno-0-7></a>        <span class=s1>'str_count'</span><span class=p>:</span> <span class=p>[</span><span class=mi>1000</span><span class=p>,</span> <span class=mi>500</span><span class=p>,</span> <span class=mi>100</span><span class=p>],</span>
<a href=#__codelineno-0-8 id=__codelineno-0-8 name=__codelineno-0-8></a>    <span class=p>},</span>
<a href=#__codelineno-0-9 id=__codelineno-0-9 name=__codelineno-0-9></a><span class=p>)</span>
<a href=#__codelineno-0-10 id=__codelineno-0-10 name=__codelineno-0-10></a><span class=n>df_str</span><span class=o>.</span><span class=n>to_csv</span><span class=p>(</span><span class=n>filename</span><span class=p>,</span> <span class=n>index</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</code></pre></div><p>The <code>float</code> type CSV file was created with:<div class=highlight><pre><span></span><code><a href=#__codelineno-1-1 id=__codelineno-1-1 name=__codelineno-1-1></a><span class=n>df_flt</span> <span class=o>=</span> <span class=n>gen_rand_df</span><span class=p>(</span>
<a href=#__codelineno-1-2 id=__codelineno-1-2 name=__codelineno-1-2></a>    <span class=n>nrow</span><span class=o>=</span><span class=mi>10000000</span><span class=p>,</span>
<a href=#__codelineno-1-3 id=__codelineno-1-3 name=__codelineno-1-3></a>    <span class=n>float_cols</span><span class=o>=</span><span class=p>{</span>
<a href=#__codelineno-1-4 id=__codelineno-1-4 name=__codelineno-1-4></a>        <span class=s1>'count'</span><span class=p>:</span> <span class=mi>3</span><span class=p>,</span>
<a href=#__codelineno-1-5 id=__codelineno-1-5 name=__codelineno-1-5></a>        <span class=s1>'name'</span><span class=p>:</span> <span class=p>[</span><span class=s1>'c1'</span><span class=p>,</span> <span class=s1>'c2'</span><span class=p>,</span> <span class=s1>'c3'</span><span class=p>],</span>
<a href=#__codelineno-1-6 id=__codelineno-1-6 name=__codelineno-1-6></a>        <span class=s1>'low'</span><span class=p>:</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=o>-</span><span class=mi>100</span><span class=p>,</span> <span class=mi>0</span><span class=p>],</span>
<a href=#__codelineno-1-7 id=__codelineno-1-7 name=__codelineno-1-7></a>        <span class=s1>'high'</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>100</span><span class=p>,</span> <span class=mf>1e5</span><span class=p>],</span>
<a href=#__codelineno-1-8 id=__codelineno-1-8 name=__codelineno-1-8></a>    <span class=p>},</span>
<a href=#__codelineno-1-9 id=__codelineno-1-9 name=__codelineno-1-9></a><span class=p>)</span>
<a href=#__codelineno-1-10 id=__codelineno-1-10 name=__codelineno-1-10></a><span class=n>df_flt</span><span class=o>.</span><span class=n>to_csv</span><span class=p>(</span><span class=n>filename</span><span class=p>,</span> <span class=n>index</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</code></pre></div><p>The <code>datetime</code> type CSV file was created with:<div class=highlight><pre><span></span><code><a href=#__codelineno-2-1 id=__codelineno-2-1 name=__codelineno-2-1></a><span class=n>df_dts</span> <span class=o>=</span> <span class=n>gen_rand_df</span><span class=p>(</span>
<a href=#__codelineno-2-2 id=__codelineno-2-2 name=__codelineno-2-2></a>    <span class=n>nrow</span><span class=o>=</span><span class=mi>10000000</span><span class=p>,</span>
<a href=#__codelineno-2-3 id=__codelineno-2-3 name=__codelineno-2-3></a>    <span class=n>ts_cols</span><span class=o>=</span><span class=p>{</span>
<a href=#__codelineno-2-4 id=__codelineno-2-4 name=__codelineno-2-4></a>        <span class=s1>'count'</span><span class=p>:</span> <span class=mi>3</span><span class=p>,</span>
<a href=#__codelineno-2-5 id=__codelineno-2-5 name=__codelineno-2-5></a>        <span class=s1>'name'</span><span class=p>:</span> <span class=p>[</span><span class=s1>'c1'</span><span class=p>,</span> <span class=s1>'c2'</span><span class=p>,</span> <span class=s1>'c3'</span><span class=p>],</span>
<a href=#__codelineno-2-6 id=__codelineno-2-6 name=__codelineno-2-6></a>        <span class=s1>'start_date'</span><span class=p>:</span> <span class=p>[</span><span class=s1>'2020-01-01'</span><span class=p>,</span> <span class=s1>'2021-01-01'</span><span class=p>,</span> <span class=s1>'2022-01-01'</span><span class=p>],</span>
<a href=#__codelineno-2-7 id=__codelineno-2-7 name=__codelineno-2-7></a>        <span class=s1>'end_date'</span><span class=p>:</span> <span class=p>[</span><span class=s1>'2021-01-01'</span><span class=p>,</span> <span class=s1>'2022-01-01'</span><span class=p>,</span> <span class=s1>'2023-01-01'</span><span class=p>],</span>
<a href=#__codelineno-2-8 id=__codelineno-2-8 name=__codelineno-2-8></a>        <span class=s1>'freq'</span><span class=p>:</span> <span class=s1>'s'</span><span class=p>,</span>
<a href=#__codelineno-2-9 id=__codelineno-2-9 name=__codelineno-2-9></a>        <span class=s1>'random'</span><span class=p>:</span> <span class=kc>False</span><span class=p>,</span>
<a href=#__codelineno-2-10 id=__codelineno-2-10 name=__codelineno-2-10></a>    <span class=p>},</span>
<a href=#__codelineno-2-11 id=__codelineno-2-11 name=__codelineno-2-11></a><span class=p>)</span>
<a href=#__codelineno-2-12 id=__codelineno-2-12 name=__codelineno-2-12></a><span class=n>df_dts</span><span class=o>.</span><span class=n>to_csv</span><span class=p>(</span><span class=n>filename</span><span class=p>,</span> <span class=n>index</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</code></pre></div><h2 id=reading-csv-files-using-pandas>Reading CSV files using <code>pandas</code><a title="Permanent link" class=headerlink href=#reading-csv-files-using-pandas>¶</a></h2><p>In pandas, when reading CSV files, there are three types of parsers that are available (<code>python</code>, <code>c</code>, and <code>pyarrow</code>). The parser can be set via the parameter <code>engine</code>. There are also two backend data types (backend_dtype: <code>numpy_nullable</code> and <code>pyarrow</code>) for storing the data. We will check the performance of the combinations of different parsers and backend data types.<p>The data types passed to the functions are a dictionary like this: <code>dtype = {'c1': type, 'c2': type, 'c3': type}</code>.<ul><li><p>For <code>string</code> values the type is <code>str</code>. There are also two string data types available for pyarrow (dtype_pa): <code>pd.ArrowDtype(pa.string())</code> and <code>string[pyarrow]</code> (dtype_pa_str2); the latter supports NumPy-backed nullable types.</p><li><p>For <code>float</code> values the type is <code>float</code> and <code>float64[pyarrow]</code>, for <code>numpy_nullable</code> and <code>pyarrow</code> backends respectively.</p><li><p>For <code>datatime</code> values the type is <code>datetime64[s]</code> and <code>pd.ArrowDtype(pa.timestamp('s'))</code>. Notice that, when using the pandas datetime data types such as <code>datetime64[s]</code>, the datetime type columns must be passed to the function separately. While using the <code>pyarrow</code> data types, all types can be passed to the function in the same format.</p></ul><p>The following options are tested:<ul><li><p>c + numpy_nullable + dtype_str + astype<div class=highlight><pre><span></span><code><a href=#__codelineno-3-1 id=__codelineno-3-1 name=__codelineno-3-1></a><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
<a href=#__codelineno-3-2 id=__codelineno-3-2 name=__codelineno-3-2></a><span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span>
<a href=#__codelineno-3-3 id=__codelineno-3-3 name=__codelineno-3-3></a>    <span class=n>file</span><span class=p>,</span> <span class=n>engine</span><span class=o>=</span><span class=s1>'c'</span><span class=p>,</span> <span class=n>dtype_backend</span><span class=o>=</span><span class=s1>'numpy_nullable'</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>dtype_str</span>
<a href=#__codelineno-3-4 id=__codelineno-3-4 name=__codelineno-3-4></a><span class=p>)</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=n>dtype</span><span class=p>)</span>
</code></pre></div><li><p>c + numpy_nullable + dtype</p></ul><p>For <code>string/float</code>:<div class=highlight><pre><span></span><code><a href=#__codelineno-4-1 id=__codelineno-4-1 name=__codelineno-4-1></a><span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span>
<a href=#__codelineno-4-2 id=__codelineno-4-2 name=__codelineno-4-2></a>    <span class=n>file</span><span class=p>,</span> <span class=n>engine</span><span class=o>=</span><span class=s1>'c'</span><span class=p>,</span> <span class=n>dtype_backend</span><span class=o>=</span><span class=s1>'numpy_nullable'</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span>
<a href=#__codelineno-4-3 id=__codelineno-4-3 name=__codelineno-4-3></a><span class=p>)</span>
</code></pre></div> For <code>datetime</code>: <div class=highlight><pre><span></span><code><a href=#__codelineno-5-1 id=__codelineno-5-1 name=__codelineno-5-1></a><span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span>
<a href=#__codelineno-5-2 id=__codelineno-5-2 name=__codelineno-5-2></a>    <span class=n>file</span><span class=p>,</span> <span class=n>engine</span><span class=o>=</span><span class=s1>'c'</span><span class=p>,</span> <span class=n>dtype_backend</span><span class=o>=</span><span class=s1>'numpy_nullable'</span><span class=p>,</span>
<a href=#__codelineno-5-3 id=__codelineno-5-3 name=__codelineno-5-3></a>    <span class=n>parse_dates</span><span class=o>=</span><span class=p>[</span><span class=s1>'c1'</span><span class=p>,</span><span class=s1>'c2'</span><span class=p>,</span><span class=s1>'c3'</span><span class=p>],</span>
<a href=#__codelineno-5-4 id=__codelineno-5-4 name=__codelineno-5-4></a><span class=p>)</span>
</code></pre></div><ul><li>c + pyarrow + dtype</ul><p>For <code>string/float</code>:<div class=highlight><pre><span></span><code><a href=#__codelineno-6-1 id=__codelineno-6-1 name=__codelineno-6-1></a><span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span>
<a href=#__codelineno-6-2 id=__codelineno-6-2 name=__codelineno-6-2></a>    <span class=n>file</span><span class=p>,</span> <span class=n>engine</span><span class=o>=</span><span class=s1>'c'</span><span class=p>,</span> <span class=n>dtype_backend</span><span class=o>=</span><span class=s1>'pyarrow'</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span>
<a href=#__codelineno-6-3 id=__codelineno-6-3 name=__codelineno-6-3></a><span class=p>)</span>
</code></pre></div> For <code>datetime</code>: <div class=highlight><pre><span></span><code><a href=#__codelineno-7-1 id=__codelineno-7-1 name=__codelineno-7-1></a><span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span>
<a href=#__codelineno-7-2 id=__codelineno-7-2 name=__codelineno-7-2></a>    <span class=n>file</span><span class=p>,</span> <span class=n>engine</span><span class=o>=</span><span class=s1>'c'</span><span class=p>,</span> <span class=n>dtype_backend</span><span class=o>=</span><span class=s1>'pyarrow'</span><span class=p>,</span>
<a href=#__codelineno-7-3 id=__codelineno-7-3 name=__codelineno-7-3></a>    <span class=n>parse_dates</span><span class=o>=</span><span class=p>[</span><span class=s1>'c1'</span><span class=p>,</span><span class=s1>'c2'</span><span class=p>,</span><span class=s1>'c3'</span><span class=p>],</span>
<a href=#__codelineno-7-4 id=__codelineno-7-4 name=__codelineno-7-4></a><span class=p>)</span>
</code></pre></div><ul><li><p>c + pyarrow + dtype_pa<div class=highlight><pre><span></span><code><a href=#__codelineno-8-1 id=__codelineno-8-1 name=__codelineno-8-1></a><span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span>
<a href=#__codelineno-8-2 id=__codelineno-8-2 name=__codelineno-8-2></a>    <span class=n>file</span><span class=p>,</span> <span class=n>engine</span><span class=o>=</span><span class=s1>'c'</span><span class=p>,</span> <span class=n>dtype_backend</span><span class=o>=</span><span class=s1>'pyarrow'</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>dtype_pa</span>
<a href=#__codelineno-8-3 id=__codelineno-8-3 name=__codelineno-8-3></a><span class=p>)</span>
</code></pre></div><li><p>pyarrow + numpy_nullable + dtype</p></ul><p>For <code>string/float</code>:<div class=highlight><pre><span></span><code><a href=#__codelineno-9-1 id=__codelineno-9-1 name=__codelineno-9-1></a><span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span>
<a href=#__codelineno-9-2 id=__codelineno-9-2 name=__codelineno-9-2></a>    <span class=n>file</span><span class=p>,</span> <span class=n>engine</span><span class=o>=</span><span class=s1>'pyarrow'</span><span class=p>,</span> <span class=n>dtype_backend</span><span class=o>=</span><span class=s1>'numpy_nullable'</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>dtype</span>
<a href=#__codelineno-9-3 id=__codelineno-9-3 name=__codelineno-9-3></a><span class=p>)</span>
</code></pre></div> For <code>datetime</code>: ```py pd.read_csv( file, engine='pyarrow', dtype_backend='numpy_nullable', parse_dates=['c1','c2','c3'], ) <ul><li><p>pyarrow + pyarrow + dtype ```py pd.read_csv( file, engine='pyarrow', dtype_backend='pyarrow', dtype=dtype )</p><li><p>pyarrow + pyarrow + string[pyarrow]<div class=highlight><pre><span></span><code><a href=#__codelineno-10-1 id=__codelineno-10-1 name=__codelineno-10-1></a><span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span>
<a href=#__codelineno-10-2 id=__codelineno-10-2 name=__codelineno-10-2></a>    <span class=n>file</span><span class=p>,</span> <span class=n>engine</span><span class=o>=</span><span class=s1>'pyarrow'</span><span class=p>,</span> <span class=n>dtype_backend</span><span class=o>=</span><span class=s1>'pyarrow'</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>dtype_pa_str2</span>
<a href=#__codelineno-10-3 id=__codelineno-10-3 name=__codelineno-10-3></a><span class=p>)</span>
</code></pre></div><li><p>pyarrow + pyarrow + dtype_pa<div class=highlight><pre><span></span><code><a href=#__codelineno-11-1 id=__codelineno-11-1 name=__codelineno-11-1></a><span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span>
<a href=#__codelineno-11-2 id=__codelineno-11-2 name=__codelineno-11-2></a>    <span class=n>file</span><span class=p>,</span> <span class=n>engine</span><span class=o>=</span><span class=s1>'pyarrow'</span><span class=p>,</span> <span class=n>dtype_backend</span><span class=o>=</span><span class=s1>'pyarrow'</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>dtype_pa</span>
<a href=#__codelineno-11-3 id=__codelineno-11-3 name=__codelineno-11-3></a><span class=p>)</span>
</code></pre></div><li><p>pyarrow + pyarrow + dtype_pa + to numpy_nullable<div class=highlight><pre><span></span><code><a href=#__codelineno-12-1 id=__codelineno-12-1 name=__codelineno-12-1></a><span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span>
<a href=#__codelineno-12-2 id=__codelineno-12-2 name=__codelineno-12-2></a>    <span class=n>file</span><span class=p>,</span> <span class=n>engine</span><span class=o>=</span><span class=s1>'pyarrow'</span><span class=p>,</span> <span class=n>dtype_backend</span><span class=o>=</span><span class=s1>'pyarrow'</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>dtype_pa</span>
<a href=#__codelineno-12-3 id=__codelineno-12-3 name=__codelineno-12-3></a><span class=p>)</span><span class=o>.</span><span class=n>convert_dtypes</span><span class=p>(</span><span class=n>dtype_backend</span><span class=o>=</span><span class=s1>'numpy_nullable'</span><span class=p>)</span>
</code></pre></div><li><p>pyarrow + pyarrow<div class=highlight><pre><span></span><code><a href=#__codelineno-13-1 id=__codelineno-13-1 name=__codelineno-13-1></a><span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span>
<a href=#__codelineno-13-2 id=__codelineno-13-2 name=__codelineno-13-2></a>    <span class=n>file</span><span class=p>,</span> <span class=n>engine</span><span class=o>=</span><span class=s1>'pyarrow'</span><span class=p>,</span> <span class=n>dtype_backend</span><span class=o>=</span><span class=s1>'pyarrow'</span>
<a href=#__codelineno-13-3 id=__codelineno-13-3 name=__codelineno-13-3></a><span class=p>)</span>
</code></pre></div></ul><p>The performance results for these options are as follows:<div class=highlight><pre><span></span><code><a href=#__codelineno-14-1 id=__codelineno-14-1 name=__codelineno-14-1></a>                                                         str    float  datetime performance_order_for_float
<a href=#__codelineno-14-2 id=__codelineno-14-2 name=__codelineno-14-2></a>c       + numpy_nullable + dtype_str + astype            3.93s  18.2s  18.5s    10
<a href=#__codelineno-14-3 id=__codelineno-14-3 name=__codelineno-14-3></a>c       + numpy_nullable + dtype                         3.88s  3.29s  15.4s     6
<a href=#__codelineno-14-4 id=__codelineno-14-4 name=__codelineno-14-4></a>c       + pyarrow        + dtype                         3.27s  3.55s  16.6s     7
<a href=#__codelineno-14-5 id=__codelineno-14-5 name=__codelineno-14-5></a>c       + pyarrow        + dtype_pa                      5.17s  16.8s  53.2s     9
<a href=#__codelineno-14-6 id=__codelineno-14-6 name=__codelineno-14-6></a>pyarrow + numpy_nullable + dtype                         3.50s  0.54s  1.15s     4
<a href=#__codelineno-14-7 id=__codelineno-14-7 name=__codelineno-14-7></a>pyarrow + pyarrow        + dtype                         7.62s  0.50s  1.67s     3
<a href=#__codelineno-14-8 id=__codelineno-14-8 name=__codelineno-14-8></a>pyarrow + pyarrow        + string[pyarrow]               4.05s  15.8s  11.1s     8
<a href=#__codelineno-14-9 id=__codelineno-14-9 name=__codelineno-14-9></a>pyarrow + pyarrow        + dtype_pa                      0.39s  0.48s  0.44s     2
<a href=#__codelineno-14-10 id=__codelineno-14-10 name=__codelineno-14-10></a>pyarrow + pyarrow        + dtype_pa + to numpy_nullable  2.74s  2.68s  1.64s     5
<a href=#__codelineno-14-11 id=__codelineno-14-11 name=__codelineno-14-11></a>pyarrow + pyarrow                                        0.48s  0.47s  0.37s     1
</code></pre></div><p>Based on the test results, we can conclude that:<ul><li><p>We can get the best performance when using <code>pyarrow</code> for the parser, backend and dtype (<code>pyarrow + pyarrow + dtype_pa</code>).</p><li><p>The <code>pyarrow + pyarrow + dtype_pa</code> option is about 10x, 7x, and 35x faster than the default option (<code>c + numpy_nullable + dtype</code>) for <code>string</code>, <code>float</code> and <code>datetime</code>, separately.</p><li><p>Compared to the <code>c</code> parser, the <code>pyarrow</code> parser is a little faster for <code>string</code>, 6x faster for <code>float</code>, and 10-14x faster for <code>datetime</code>.</p><li><p>Using the <code>pyarrow</code> backend with the <code>c</code> parser, there are no performance improvements; if also using the <code>pyarrow</code> dtype the performance is much worse.</p><li><p>The <code>pd.ArrowDtype(pa.string())</code> string data type is about 10x faster than the <code>string[pyarrow]</code> string data type.</p><li><p>The <code>pyarrow</code> parser can automatically determine the data types without any performance loss; this is especially useful when you do not know the data types in the CSV files.</p></ul><p>We should understand that the <code>pyarrow</code> parser works in parallel mode while the <code>c</code> parser is not. Also converting the data from the <code>numpy_nullable</code> to <code>pyarrow</code> dtype or vice versa might be time-consuming.<h2 id=reading-csv-files-using-polars>Reading CSV files using <code>polars</code><a title="Permanent link" class=headerlink href=#reading-csv-files-using-polars>¶</a></h2><p>The <code>polars</code> package is relatively new. But it becomes popular recently due to its performance both in speed with vectorized execution and memory efficiency using <code>arrow</code>. Also it is designed with a clean and concise API for handling large datasets with lazy evaluation.<p>The data types passed to the <code>polars</code> functions are a dictionary like this: <code>dtypes = {'c1': dtype, 'c2': dtype, 'c3': dtype}</code>.<ul><li><p>For <code>string</code> values the dtype is <code>pl.Utf8</code>.</p><li><p>For <code>float</code> values the dtype is <code>pl.Float64</code>.</p><li><p>For <code>datatime</code> values the dtype is <code>pl.Datetime</code>.</p></ul><p>The following options are tested:<ul><li><p>default: without providing the dtypes parameter. Note that if some columns with <code>float</code> type have empty values, the data type will be parsed as <code>string</code> - not smart enough compared to <code>pyarrow.csv</code>.<div class=highlight><pre><span></span><code><a href=#__codelineno-15-1 id=__codelineno-15-1 name=__codelineno-15-1></a><span class=kn>import</span><span class=w> </span><span class=nn>polars</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pl</span>
<a href=#__codelineno-15-2 id=__codelineno-15-2 name=__codelineno-15-2></a><span class=n>pl</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=n>file</span><span class=p>)</span>
</code></pre></div><li><p>eager: the default mode, any operations are executed immediately<div class=highlight><pre><span></span><code><a href=#__codelineno-16-1 id=__codelineno-16-1 name=__codelineno-16-1></a><span class=n>pl</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=n>file</span><span class=p>,</span> <span class=n>dtypes</span><span class=o>=</span><span class=n>dtypes</span><span class=p>)</span>
</code></pre></div><li><p>lazy: operations are not executed until you explicitly call the <code>collect()</code> method<div class=highlight><pre><span></span><code><a href=#__codelineno-17-1 id=__codelineno-17-1 name=__codelineno-17-1></a><span class=n>pl</span><span class=o>.</span><span class=n>scan_csv</span><span class=p>(</span><span class=n>file</span><span class=p>,</span> <span class=n>dtypes</span><span class=o>=</span><span class=n>dtypes</span><span class=p>)</span><span class=o>.</span><span class=n>collect</span><span class=p>()</span>
</code></pre></div><li><p>streaming: it processes the data in batches instead of loading everything at once, good for handling large datasets that might exceed available memory<div class=highlight><pre><span></span><code><a href=#__codelineno-18-1 id=__codelineno-18-1 name=__codelineno-18-1></a><span class=n>pl</span><span class=o>.</span><span class=n>scan_csv</span><span class=p>(</span><span class=n>file</span><span class=p>,</span> <span class=n>dtypes</span><span class=o>=</span><span class=n>dtypes</span><span class=p>)</span><span class=o>.</span><span class=n>collect</span><span class=p>(</span><span class=n>streaming</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</code></pre></div><li><p>sql api eager: interact with data using familiar SQL syntax<div class=highlight><pre><span></span><code><a href=#__codelineno-19-1 id=__codelineno-19-1 name=__codelineno-19-1></a><span class=n>pl</span><span class=o>.</span><span class=n>SQLContext</span><span class=p>(</span>
<a href=#__codelineno-19-2 id=__codelineno-19-2 name=__codelineno-19-2></a>    <span class=n>data</span><span class=o>=</span><span class=n>pl</span><span class=o>.</span><span class=n>scan_csv</span><span class=p>(</span><span class=n>file</span><span class=p>,</span> <span class=n>dtypes</span><span class=o>=</span><span class=n>dtypes</span><span class=p>)</span>
<a href=#__codelineno-19-3 id=__codelineno-19-3 name=__codelineno-19-3></a><span class=p>)</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span><span class=s1>'select * from data'</span><span class=p>,</span> <span class=n>eager</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</code></pre></div><li><p>sql api eager + to pandas<div class=highlight><pre><span></span><code><a href=#__codelineno-20-1 id=__codelineno-20-1 name=__codelineno-20-1></a><span class=n>pl</span><span class=o>.</span><span class=n>SQLContext</span><span class=p>(</span>
<a href=#__codelineno-20-2 id=__codelineno-20-2 name=__codelineno-20-2></a>    <span class=n>data</span><span class=o>=</span><span class=n>pl</span><span class=o>.</span><span class=n>scan_csv</span><span class=p>(</span><span class=n>file</span><span class=p>,</span> <span class=n>dtypes</span><span class=o>=</span><span class=n>dtypes</span><span class=p>)</span>
<a href=#__codelineno-20-3 id=__codelineno-20-3 name=__codelineno-20-3></a><span class=p>)</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span>
<a href=#__codelineno-20-4 id=__codelineno-20-4 name=__codelineno-20-4></a>    <span class=s1>'select * from data'</span><span class=p>,</span> <span class=n>eager</span><span class=o>=</span><span class=kc>True</span>
<a href=#__codelineno-20-5 id=__codelineno-20-5 name=__codelineno-20-5></a><span class=p>)</span><span class=o>.</span><span class=n>to_pandas</span><span class=p>(</span><span class=n>use_pyarrow_extension_array</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</code></pre></div><li><p>sql api eager + to pandas pyarrow<div class=highlight><pre><span></span><code><a href=#__codelineno-21-1 id=__codelineno-21-1 name=__codelineno-21-1></a><span class=n>pl</span><span class=o>.</span><span class=n>SQLContext</span><span class=p>(</span>
<a href=#__codelineno-21-2 id=__codelineno-21-2 name=__codelineno-21-2></a>    <span class=n>data</span><span class=o>=</span><span class=n>pl</span><span class=o>.</span><span class=n>scan_csv</span><span class=p>(</span><span class=n>file</span><span class=p>,</span> <span class=n>dtypes</span><span class=o>=</span><span class=n>dtypes</span><span class=p>)</span>
<a href=#__codelineno-21-3 id=__codelineno-21-3 name=__codelineno-21-3></a><span class=p>)</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span>
<a href=#__codelineno-21-4 id=__codelineno-21-4 name=__codelineno-21-4></a>    <span class=s1>'select * from data'</span><span class=p>,</span> <span class=n>eager</span><span class=o>=</span><span class=kc>True</span>
<a href=#__codelineno-21-5 id=__codelineno-21-5 name=__codelineno-21-5></a><span class=p>)</span><span class=o>.</span><span class=n>to_pandas</span><span class=p>(</span><span class=n>use_pyarrow_extension_array</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</code></pre></div></ul><p>The tested performance results are as follows:<div class=highlight><pre><span></span><code><a href=#__codelineno-22-1 id=__codelineno-22-1 name=__codelineno-22-1></a>                                          str    float  datetime
<a href=#__codelineno-22-2 id=__codelineno-22-2 name=__codelineno-22-2></a>default                                   0.52s  0.38s  0.37s
<a href=#__codelineno-22-3 id=__codelineno-22-3 name=__codelineno-22-3></a>eager                                     0.46s  0.40s  0.39s
<a href=#__codelineno-22-4 id=__codelineno-22-4 name=__codelineno-22-4></a>lazy                                      0.45s  0.38s  0.41s
<a href=#__codelineno-22-5 id=__codelineno-22-5 name=__codelineno-22-5></a>streaming                                 0.42s  0.40s  0.42s
<a href=#__codelineno-22-6 id=__codelineno-22-6 name=__codelineno-22-6></a>sql api eager                             0.46s  0.38s  0.40s
<a href=#__codelineno-22-7 id=__codelineno-22-7 name=__codelineno-22-7></a>sql api eager + to pandas                 1.59s  0.47s  0.48s
<a href=#__codelineno-22-8 id=__codelineno-22-8 name=__codelineno-22-8></a>sql api eager + to pandas pyarrow         0.99s  0.43s  0.45s
</code></pre></div><p>It is obvious from the results that:<ul><li><p>The performance is quite consistent for all the options using <code>polars</code>.</p><li><p>The <code>polars</code> CSV reading has a similar performance compared to <code>pandas</code> with <code>pyarrow</code>.</p><li><p>If we need a <code>numpy_nullable</code> pandas DataFrame, <code>polars</code> can still be a better option.</p></ul><h2 id=reading-csv-files-using-pyarrowcsv>Reading CSV files using <code>pyarrow.csv</code><a title="Permanent link" class=headerlink href=#reading-csv-files-using-pyarrowcsv>¶</a></h2><p>The module, <code>pyarrow.csv</code>, is one of the great modules within the <code>pyarrow</code> library that specifically deals with reading and writing CSV files. It offers robust functionalities to efficiently process CSV data with some great features, such as inferring data types during reading and supporting various file formats.<p>Here we test the performance of the <code>pyarrow.csv</code> module with three data types in the format <code>convert_options = pv.ConvertOptions(column_types={'c1': dtype, 'c2': dtype, 'c3': dtype})</code>.<ul><li><p>For <code>string</code> values the dtype is <code>pa.string()</code>.</p><li><p>For <code>float</code> values the dtype is <code>pa.float64()</code>.</p><li><p>For <code>datatime</code> values the dtype is <code>pa.timestamp('s')</code>.</p></ul><p>The following options are tested and compared:<ul><li><p>default<div class=highlight><pre><span></span><code><a href=#__codelineno-23-1 id=__codelineno-23-1 name=__codelineno-23-1></a><span class=kn>import</span><span class=w> </span><span class=nn>pyarrow.csv</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pv</span>
<a href=#__codelineno-23-2 id=__codelineno-23-2 name=__codelineno-23-2></a><span class=n>pv</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=n>file</span><span class=p>)</span>
</code></pre></div><li><p>default + to pandas<div class=highlight><pre><span></span><code><a href=#__codelineno-24-1 id=__codelineno-24-1 name=__codelineno-24-1></a><span class=n>pv</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=n>file</span><span class=p>)</span><span class=o>.</span><span class=n>to_pandas</span><span class=p>()</span>
</code></pre></div><li><p>default + to pandas pyarrow<div class=highlight><pre><span></span><code><a href=#__codelineno-25-1 id=__codelineno-25-1 name=__codelineno-25-1></a><span class=n>pv</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=n>file</span><span class=p>)</span><span class=o>.</span><span class=n>to_pandas</span><span class=p>(</span><span class=n>types_mapper</span><span class=o>=</span><span class=n>pd</span><span class=o>.</span><span class=n>ArrowDtype</span><span class=p>)</span>
</code></pre></div><li><p>dtype<div class=highlight><pre><span></span><code><a href=#__codelineno-26-1 id=__codelineno-26-1 name=__codelineno-26-1></a><span class=n>pv</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=n>file</span><span class=p>,</span> <span class=n>convert_options</span><span class=o>=</span><span class=n>convert_options</span><span class=p>)</span>
</code></pre></div><li><p>dtype + to pandas<div class=highlight><pre><span></span><code><a href=#__codelineno-27-1 id=__codelineno-27-1 name=__codelineno-27-1></a><span class=n>pv</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=n>file</span><span class=p>,</span> <span class=n>convert_options</span><span class=o>=</span><span class=n>convert_options</span><span class=p>)</span><span class=o>.</span><span class=n>to_pandas</span><span class=p>()</span>
</code></pre></div><li><p>dtype + to pandas pyarrow<div class=highlight><pre><span></span><code><a href=#__codelineno-28-1 id=__codelineno-28-1 name=__codelineno-28-1></a><span class=n>pv</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=n>file</span><span class=p>,</span> <span class=n>convert_options</span><span class=o>=</span><span class=n>convert_options</span><span class=p>)</span><span class=o>.</span><span class=n>to_pandas</span><span class=p>(</span><span class=n>types_mapper</span><span class=o>=</span><span class=n>pd</span><span class=o>.</span><span class=n>ArrowDtype</span><span class=p>)</span>
</code></pre></div></ul><p>The performance results for the previous options are shown here:<div class=highlight><pre><span></span><code><a href=#__codelineno-29-1 id=__codelineno-29-1 name=__codelineno-29-1></a>                               str    float  datetime
<a href=#__codelineno-29-2 id=__codelineno-29-2 name=__codelineno-29-2></a>default                        0.39s  0.44s  0.38s
<a href=#__codelineno-29-3 id=__codelineno-29-3 name=__codelineno-29-3></a>default + to pandas            1.07s  0.45s  0.42s
<a href=#__codelineno-29-4 id=__codelineno-29-4 name=__codelineno-29-4></a>default + to pandas pyarrow    0.48s  0.43s  0.33s
<a href=#__codelineno-29-5 id=__codelineno-29-5 name=__codelineno-29-5></a>dtype                          0.39s  0.40s  0.36s
<a href=#__codelineno-29-6 id=__codelineno-29-6 name=__codelineno-29-6></a>dtype   + to pandas            0.99s  0.45s  0.41s
<a href=#__codelineno-29-7 id=__codelineno-29-7 name=__codelineno-29-7></a>dtype   + to pandas pyarrow    0.39s  0.42s  0.37s
</code></pre></div><p>From these results we can conclude that:<ul><li><p>The <code>pyarrow.csv</code> module has a similar performance compared to <code>polars</code>.</p><li><p>If we need to load CSV files into a <code>pandas</code> DataFrame, <code>pyarrow.csv</code> is the fastest option.</p></ul><h2 id=best-options-from-pandas-polars-and-pyarrow>Best options from <code>pandas</code>, <code>polars</code>, and <code>pyarrow</code><a title="Permanent link" class=headerlink href=#best-options-from-pandas-polars-and-pyarrow>¶</a></h2><p>There is no surprise that all options using <code>arrow</code> to store data have a similar performance for reading CSV files; <code>polars</code> also uses <code>arrow</code> to save the data in memory. The <code>arrow</code> package is not just faster by parallelizing the reading, it is also more memory efficient.<p>The <code>polars</code> package is relatively new compared to <code>pandas</code>. It has some great new features but might not have the functions we need. It's entirely up to us to decide which package to use. If we use <code>polars</code> do all our data manipulations I would suggest we stick to <code>polars</code> for reading CSV files.<p>If <code>pandas</code> is still our preference, to load CSV files efficiently, we should use the <code>pyarrow</code> parser, backend and dtype or <code>pyarrow.csv</code> to improve the performance further. If we also need to use the <code>numpy_nullable</code> backend, it is best to read CSV files using <code>pyarrow.csv</code> and then convert the backend to <code>numpy_nullable</code>.</article></div><script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script></div><button class="md-top md-icon" data-md-component=top hidden type=button><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top</button></main><footer class=md-footer><div class="md-footer-meta md-typeset"><div class="md-footer-meta__inner md-grid"><div class=md-copyright><div class=md-copyright__highlight><a title="Go to Main Home Page" href=/>🏠 Back to Home</a><br> Copyright © 2026 Sean Ma <br>Last updated on 17 Jan 2026</div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ rel=noopener target=_blank> Material for MkDocs </a></div></div></div></footer></div><div class=md-dialog data-md-component=dialog><div class="md-dialog__inner md-typeset"></div></div><script id=__config type=application/json>{"base": "../../..", "features": ["navigation.tabs", "navigation.expand", "navigation.indexes", "navigation.top", "toc.follow", "search.suggest", "search.highlight", "content.code.copy", "navigation.prune"], "search": "../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script><script src=../../../assets/javascripts/bundle.56ea9cef.min.js></script>